import{a as G}from"./chunk-GGPG3CNO.js";import{Aa as V,B as C,Ba as k,C as c,Ca as E,D as i,Da as F,E as a,F as M,Ga as W,Ib as H,J as S,Ja as B,Jb as A,K as b,Mb as D,Qb as R,S as u,X as w,Y as g,Z as f,cb as N,j as d,jb as O,k as l,ka as v,kb as j,r as n,rb as z,s as h,ta as I,u as y,wb as L,xb as q,za as T}from"./chunk-GKQ2PQVS.js";import"./chunk-L2GIMNSN.js";import"./chunk-7KGURMOZ.js";import"./chunk-YZINE4VV.js";import"./chunk-OITPVWB3.js";import"./chunk-YXCBSPVC.js";import"./chunk-HII7ZFLR.js";import"./chunk-7JVEMCNU.js";import"./chunk-Z65EUC5N.js";import"./chunk-4U6PRYVA.js";import"./chunk-ETCIABSX.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{f as _}from"./chunk-RW4GY4BD.js";var ee=(()=>{let s=class s{constructor(r,o){this.router=r,this.toastController=o,this.password="",this.newPassword="",this.confirmPassword="",this.formSubmitted=!1}ngOnInit(){}get formInvalid(){return!this.password||!this.newPassword||!this.confirmPassword}cambiarPass(){if(this.formSubmitted=!0,this.formInvalid)return;if(this.newPassword!==this.confirmPassword){alert("Las contrase\xF1as no coinciden");return}let r=localStorage.getItem("accessToken");if(!r){console.log("No se encontr\xF3 el token de acceso");return}let o=G.apiUrl+"/usuario/actualizarPassword";fetch(o,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({password:this.password,newPassword:this.newPassword})}).then(e=>e.text()).then(e=>{e.trim()==="Contrase\xF1a actualizada"?(this.presentToast("Contrase\xF1a actualizada"),this.router.navigate(["/ajustes"])):this.presentToast("Error: "+e)}).catch(e=>{console.error("Error en la solicitud:",e),alert("Error en la solicitud")})}cancelar(){this.router.navigate(["/ajustes"])}presentToast(r){return _(this,null,function*(){yield(yield this.toastController.create({message:r,duration:2e3,position:"top",cssClass:"toast"})).present()})}};s.\u0275fac=function(o){return new(o||s)(h(I),h(D))},s.\u0275cmp=y({type:s,selectors:[["app-cambiar-password"]],decls:20,vars:13,consts:[["registerForm","ngForm"],[3,"translucent"],["slot","start"],["defaultHref","/ajustes"],[3,"fullscreen"],[1,"centrar"],[1,"cambiarPass",3,"ngSubmit"],["type","password","placeholder","Contrase\xF1a","name","password","required","",3,"ngModelChange","ngModel"],["type","password","placeholder","Contrase\xF1a nueva","name","newPassword","required","",3,"ngModelChange","ngModel"],["type","password","placeholder","Confirmar contrase\xF1a","name","confirmPassword","required","",3,"ngModelChange","ngModel"],["expand","block","type","submit",1,"boton"],["expand","block",1,"boton",3,"click"]],template:function(o,e){if(o&1){let m=S();i(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-buttons",2),M(3,"ion-back-button",3),a(),i(4,"ion-title"),u(5,"Cambiar contrase\xF1a"),a()()(),i(6,"ion-content",4)(7,"div",5)(8,"form",6,0),b("ngSubmit",function(){return d(m),l(e.cambiarPass())}),i(10,"ion-item")(11,"ion-input",7),f("ngModelChange",function(t){return d(m),g(e.password,t)||(e.password=t),l(t)}),a()(),i(12,"ion-item")(13,"ion-input",8),f("ngModelChange",function(t){return d(m),g(e.newPassword,t)||(e.newPassword=t),l(t)}),a()(),i(14,"ion-item")(15,"ion-input",9),f("ngModelChange",function(t){return d(m),g(e.confirmPassword,t)||(e.confirmPassword=t),l(t)}),a()(),i(16,"ion-button",10),u(17," Cambiar contrase\xF1a "),a(),i(18,"ion-button",11),b("click",function(){return d(m),l(e.cancelar())}),u(19," Cancelar "),a()()()()}o&2&&(C("translucent",!0),n(6),C("fullscreen",!0),n(4),c("invalid",!e.password&&e.formSubmitted),n(),w("ngModel",e.password),n(),c("invalid",!e.newPassword&&e.formSubmitted),n(),w("ngModel",e.newPassword),n(),c("invalid",!e.confirmPassword&&e.formSubmitted),n(),w("ngModel",e.confirmPassword),n(),c("disabled",e.formInvalid))},dependencies:[z,L,H,A,v,B,F,T,V,W,E,k,q,O,R,N,j],styles:[".cambiarPass[_ngcontent-%COMP%]{padding-left:20px;padding-right:20px;padding-top:20px}.boton[_ngcontent-%COMP%]{padding:20px 20px 0}.invalid[_ngcontent-%COMP%]{border:2px solid red;--ion-color: red}.error-text[_ngcontent-%COMP%]{color:red;font-size:14px;text-align:center;margin-top:5px}.disabled[_ngcontent-%COMP%]{pointer-events:auto}"]});let P=s;return P})();export{ee as CambiarPasswordPage};
