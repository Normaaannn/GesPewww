import{a as h}from"./chunk-GGPG3CNO.js";import{B as u,D as r,E as i,F as c,Ib as D,Ja as x,Jb as N,K as g,Mb as A,S as s,U as m,cb as v,gb as C,ha as U,jb as T,ka as E,kb as _,r as n,rb as k,s as d,ta as I,u as f,wb as B,xb as R,y as p,yb as S,zb as y}from"./chunk-GKQ2PQVS.js";import"./chunk-L2GIMNSN.js";import"./chunk-7KGURMOZ.js";import"./chunk-YZINE4VV.js";import"./chunk-OITPVWB3.js";import"./chunk-YXCBSPVC.js";import"./chunk-HII7ZFLR.js";import"./chunk-7JVEMCNU.js";import"./chunk-Z65EUC5N.js";import"./chunk-4U6PRYVA.js";import"./chunk-ETCIABSX.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{f as b}from"./chunk-RW4GY4BD.js";function M(l,a){l&1&&(r(0,"ion-button",10),s(1,"Dar rol de usuario"),i())}function P(l,a){l&1&&(r(0,"ion-button",11),s(1,"Eliminar"),i())}var q=(()=>{let a=class a{constructor(t,o){this.router=t,this.toastController=o,this.rolUsuario=!1,this.baneado=!1,this.alertButtonsEliminarUsuario=[{text:"No",cssClass:"alert-button-cancel"},{text:"Si",cssClass:"alert-button-confirm",handler:()=>{this.eliminarUsuario()}}],this.alertButtonsDarRolUsuario=[{text:"No",cssClass:"alert-button-cancel"},{text:"Si",cssClass:"alert-button-confirm",handler:()=>{this.darRolUsuario()}}]}ngOnInit(){let t=this.router.getCurrentNavigation();t!=null&&t.extras.state&&(this.usuario=t.extras.state.usuario),this.esUsuario(),this.esBaneado()}darRolUsuario(){let t=localStorage.getItem("accessToken");if(!t){console.log("No se encontr\xF3 el token de acceso");return}let o=h.apiUrl+`/usuario/${this.usuario.id}/darRolUsuario`;fetch(o,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}}).then(e=>e.text()).then(e=>{e.trim()==="Usuario activado correctamente"?(this.presentToast("Usuario activado"),this.router.navigate(["/usuarios"])):this.presentToast("Error en el registro: "+e)}).catch(e=>{console.error("Error en la solicitud:",e),alert("Error en la solicitud")})}eliminarUsuario(){let t=localStorage.getItem("accessToken");if(!t){console.log("No se encontr\xF3 el token de acceso");return}let o=h.apiUrl+`/usuario/${this.usuario.id}/banear`;fetch(o,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}}).then(e=>e.text()).then(e=>{e.trim()==="Usuario baneado correctamente"?(this.presentToast("Usuario baneado"),this.router.navigate(["/usuarios"])):this.presentToast("Error: "+e)}).catch(e=>{console.error("Error en la solicitud:",e),alert("Error en la solicitud")})}esUsuario(){this.usuario.role==="ROLE_USER"||this.usuario.role==="ROLE_ADMIN"?this.rolUsuario=!0:this.rolUsuario=!1}esBaneado(){this.usuario.role==="ROLE_BANNED"?this.baneado=!0:this.baneado=!1}presentToast(t){return b(this,null,function*(){(yield this.toastController.create({message:t,duration:2e3,position:"top",cssClass:"custom-toast"})).present()})}cancelar(){this.router.navigate(["/usuarios"])}};a.\u0275fac=function(o){return new(o||a)(d(I),d(A))},a.\u0275cmp=f({type:a,selectors:[["app-usuario-detalle"]],decls:27,vars:9,consts:[[3,"translucent"],["slot","start"],["defaultHref","/ajustes"],[3,"fullscreen"],[1,"centrar"],["id","darRolUsuario","expand","block","color","success","class","boton",4,"ngIf"],["trigger","darRolUsuario","header","Vas a dar el rol usuario. \xBFEst\xE1s seguro?",1,"custom-alert",3,"buttons"],["id","eliminarUsuario","expand","block","color","danger","class","boton-eliminar",4,"ngIf"],["trigger","eliminarUsuario","header","Vas a eliminar al usuario. \xBFEst\xE1s seguro?",1,"custom-alert",3,"buttons"],["expand","block",1,"boton",3,"click"],["id","darRolUsuario","expand","block","color","success",1,"boton"],["id","eliminarUsuario","expand","block","color","danger",1,"boton-eliminar"]],template:function(o,e){o&1&&(r(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),c(3,"ion-back-button",2),i(),r(4,"ion-title"),s(5,"Usuario"),i()()(),r(6,"ion-content",3)(7,"div",4),c(8,"br"),r(9,"ion-list")(10,"ion-item")(11,"ion-label"),s(12),i(),c(13,"br"),i(),r(14,"ion-item")(15,"ion-label"),s(16),i(),c(17,"br"),i(),r(18,"ion-item")(19,"ion-label"),s(20),i()()(),p(21,M,2,0,"ion-button",5),c(22,"ion-alert",6),p(23,P,2,0,"ion-button",7),c(24,"ion-alert",8),r(25,"ion-button",9),g("click",function(){return e.cancelar()}),s(26,"Atr\xE1s"),i()()()),o&2&&(u("translucent",!0),n(6),u("fullscreen",!0),n(6),m("Usuario: ",e.usuario.username,""),n(4),m("Email: ",e.usuario.email,""),n(4),m("Rol: ",e.usuario.role,""),n(),u("ngIf",!e.rolUsuario),n(),u("buttons",e.alertButtonsDarRolUsuario),n(),u("ngIf",!e.baneado),n(),u("buttons",e.alertButtonsEliminarUsuario))},dependencies:[k,B,D,N,E,U,x,_,v,S,T,C,y,R],styles:[".boton[_ngcontent-%COMP%]{padding:20px 20px 0}.boton-eliminar[_ngcontent-%COMP%]{padding-left:20px;padding-right:20px;padding-top:20px}"]});let l=a;return l})();export{q as UsuarioDetallePage};
