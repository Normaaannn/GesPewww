import{a as N}from"./chunk-3RMIGUHL.js";import"./chunk-CRMNYVNJ.js";import"./chunk-DWTMSAJF.js";import"./chunk-EIUGSWZD.js";import"./chunk-TW6IKH4B.js";import"./chunk-ZWHDOK3R.js";import"./chunk-4PGTP63H.js";import"./chunk-BDVXA75T.js";import"./chunk-HC6MZPB3.js";import"./chunk-I3LG7LOT.js";import"./chunk-FERD25SW.js";import"./chunk-7EU7YSXT.js";import"./chunk-LEIMCQKJ.js";import"./chunk-KKMBB4JE.js";import"./chunk-BZ2JL7UE.js";import"./chunk-5OMUW5VI.js";import"./chunk-OBXDPQ3V.js";import"./chunk-GZWEEWZ4.js";import"./chunk-MCRJI3T3.js";import"./chunk-MAJNWM2K.js";import"./chunk-5LUBTVRJ.js";import{a as B}from"./chunk-GGPG3CNO.js";import{$ as C,B as m,D as i,E as o,F as h,Fb as $,Gb as H,Ha as D,J as g,K as f,L as b,S as s,T,U as p,V as v,aa as x,fa as I,ia as S,j as d,ja as A,k as u,pb as M,r as l,s as E,sa as w,tb as y,u as P,ub as F,vb as k,wb as O,xb as V,y as _}from"./chunk-GOUZPZED.js";import"./chunk-L2GIMNSN.js";import"./chunk-7KGURMOZ.js";import"./chunk-YZINE4VV.js";import"./chunk-OITPVWB3.js";import"./chunk-YXCBSPVC.js";import"./chunk-HII7ZFLR.js";import"./chunk-7JVEMCNU.js";import"./chunk-Z65EUC5N.js";import"./chunk-4U6PRYVA.js";import"./chunk-ETCIABSX.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import"./chunk-RW4GY4BD.js";function U(a,c){if(a&1){let n=g();i(0,"ion-item",4),f("click",function(){let r=d(n).$implicit,e=b();return u(e.goToPedidoDetalle(r))}),i(1,"ion-label")(2,"p"),s(3),o(),i(4,"p"),s(5),C(6,"number"),o()()()}if(a&2){let n=c.$implicit;m("button",!0),l(3),p("Pedido #",n.id,""),l(2),p("Total: ",x(6,3,n.total,"1.2-2")," \u20AC")}}function z(a,c){if(a&1){let n=g();i(0,"ion-item",4),f("click",function(){let r=d(n).$implicit,e=b();return u(e.goToClienteDetalle(r))}),i(1,"ion-label")(2,"p"),s(3),o(),i(4,"p"),s(5),o()()()}if(a&2){let n=c.$implicit;m("button",!0),l(3),v("Cliente: ",n.nombre," ",n.apellidos,""),l(2),p("NIF: ",n.nif," \u20AC")}}function G(a,c){if(a&1){let n=g();i(0,"ion-item",4),f("click",function(){let r=d(n).$implicit,e=b();return u(e.goToProductoDetalle(r))}),i(1,"ion-label")(2,"p"),s(3),o(),i(4,"p"),s(5),C(6,"number"),o()()()}if(a&2){let n=c.$implicit;m("button",!0),l(3),v("Producto: ",n.nombre," ",n.descripcion,""),l(2),p("Precio: ",x(6,4,n.precioBruto,"1.2-2")," \u20AC")}}var X=(()=>{let c=class c{constructor(t){this.router=t,this.mesAnioActual="",this.total=0,this.pedidos=[],this.clientes=[],this.productos=[]}ionViewWillEnter(){this.mesAnioActual=this.obtenerMesAnioActual(),this.obtenerTresUltimos()}obtenerMesAnioActual(){let t=new Date,e=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][t.getMonth()],j=t.getFullYear();return`${e} ${j}`}obtenerTresUltimos(){let t=localStorage.getItem("accessToken");if(!t){console.log("No se encontr\xF3 el token de acceso");return}let r=B.apiUrl+"/misc/datosHome";fetch(r,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}}).then(e=>{if(!e.ok)throw new Error("Error en la solicitud");return e.json()}).then(e=>{console.log("Respuesta completa:",e),e?(this.total=e.total||0,this.pedidos=e.pedidos||[],this.clientes=e.clientes||[],this.productos=e.productos||[],console.log("Pedidos:",this.pedidos),console.log("Clientes:",this.clientes),console.log("Productos:",this.productos)):console.warn("Datos vac\xEDos o inesperados:",e)}).catch(e=>{console.error("Error al obtener los datos:",e)})}goToPedidoDetalle(t){this.router.navigate(["/pedido-detalle"],{state:{pedidoId:t.id,pedidoFecha:t.fechaEmision,cliente:t.cliente,usuarioCreador:t.usuarioCreador.username}})}goToClienteDetalle(t){this.router.navigate(["/cliente-detalle"],{state:{cliente:t}})}goToProductoDetalle(t){this.router.navigate(["/producto-detalle"],{state:{producto:t}})}};c.\u0275fac=function(r){return new(r||c)(E(w))},c.\u0275cmp=P({type:c,selectors:[["app-home"]],decls:32,vars:10,consts:[[3,"translucent"],[3,"fullscreen"],[1,"centrar"],[3,"button","click",4,"ngFor","ngForOf"],[3,"click","button"]],template:function(r,e){r&1&&(i(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title")(3,"b"),s(4,"GesPe"),o()()()(),i(5,"ion-content",1)(6,"div",2)(7,"div")(8,"h1")(9,"b"),s(10),o()(),i(11,"h3")(12,"b"),s(13),C(14,"number"),o()()(),h(15,"br"),i(16,"div")(17,"h5"),s(18,"\xDAltimos pedidos"),o(),i(19,"ion-list"),_(20,U,7,6,"ion-item",3),o(),i(21,"h5"),s(22,"\xDAltimos clientes"),o(),i(23,"ion-list"),_(24,z,6,4,"ion-item",3),o(),i(25,"h5"),s(26,"\xDAltimos productos"),o(),i(27,"ion-list"),_(28,G,7,7,"ion-item",3),o()()(),h(29,"br"),o(),i(30,"ion-footer"),h(31,"app-tabs"),o()),r&2&&(m("translucent",!0),l(5),m("fullscreen",!0),l(5),T(e.mesAnioActual),l(3),p("Total facturado ",x(14,7,e.total,"1.2-2")," \u20AC"),l(7),m("ngForOf",e.pedidos),l(4),m("ngForOf",e.clientes),l(4),m("ngForOf",e.productos))},dependencies:[M,F,$,H,A,I,S,D,N,y,V,k,O],styles:["h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], h6[_ngcontent-%COMP%]{padding-left:10px}"]});let a=c;return a})();export{X as HomePage};
