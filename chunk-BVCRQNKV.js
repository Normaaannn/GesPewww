import{a as x}from"./chunk-GGPG3CNO.js";import{B as u,D as a,E as i,F as l,Ib as L,Ja as P,Jb as z,K as C,S as t,U as r,V as h,aa as I,ba as f,cb as y,eb as T,fb as A,ga as F,ja as S,jb as _,ka as k,kb as w,lb as B,mb as N,nb as O,ob as $,pb as j,r as n,rb as U,s as g,ta as D,u as v,vb as G,wb as M,xb as R,y as E,yb as H}from"./chunk-GKQ2PQVS.js";import"./chunk-L2GIMNSN.js";import"./chunk-7KGURMOZ.js";import"./chunk-YZINE4VV.js";import"./chunk-OITPVWB3.js";import"./chunk-YXCBSPVC.js";import"./chunk-HII7ZFLR.js";import"./chunk-7JVEMCNU.js";import"./chunk-Z65EUC5N.js";import"./chunk-4U6PRYVA.js";import"./chunk-ETCIABSX.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import"./chunk-RW4GY4BD.js";function J(p,c){if(p&1&&(a(0,"ion-accordion")(1,"ion-item",7)(2,"ion-label"),t(3),I(4,"number"),i()(),a(5,"div",8)(6,"p")(7,"strong"),t(8,"Descripci\xF3n:"),i(),t(9),i(),a(10,"p")(11,"strong"),t(12,"IVA:"),i(),t(13),i(),a(14,"p")(15,"strong"),t(16,"Cantidad:"),i(),t(17),i(),a(18,"p")(19,"strong"),t(20,"Precio unitario neto:"),i(),t(21),I(22,"number"),i(),a(23,"p")(24,"strong"),t(25,"Precio unitario bruto:"),i(),t(26),I(27,"number"),i()()()),p&2){let d=c.$implicit;n(3),h(" ",d.nombreProducto," - ",f(4,7,d.subtotal,"1.2-2")," \u20AC "),n(6),r(" ",d.descripcion,""),n(4),r(" ",d.iva,"%"),n(4),r(" ",d.cantidad,""),n(4),r(" ",f(22,10,d.precio,"1.2-2")," \u20AC"),n(5),r(" ",f(27,13,d.precio+d.precio*d.iva/100,"1.2-2")," \u20AC")}}var Z=(()=>{let c=class c{constructor(o){this.router=o}ngOnInit(){let o=this.router.getCurrentNavigation();o!=null&&o.extras.state&&(this.pedidoId=o.extras.state.pedidoId,this.pedidoFecha=o.extras.state.pedidoFecha,this.cliente=o.extras.state.cliente,this.usuarioCreador=o.extras.state.usuarioCreador,this.loadDetalles())}loadDetalles(){let o=localStorage.getItem("accessToken");if(!o){console.log("No se encontr\xF3 el token de acceso");return}let s=x.apiUrl+`/pedidos/${this.pedidoId}/detalles`;fetch(s,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`}}).then(e=>{if(!e.ok)throw new Error("Error en la solicitud");return e.json()}).then(e=>{console.log("Respuesta completa:",e),typeof e=="string"&&(e=JSON.parse(e),console.log("Convertido a JSON:",e)),Array.isArray(e)?this.detalles=e:e&&e.content?this.detalles=e.content:console.warn("Formato de datos inesperado:",e)})}generarPDF(){let o=localStorage.getItem("accessToken");if(!o){console.log("No se encontr\xF3 el token de acceso");return}let s=x.apiUrl+`/pedido/factura/${this.pedidoId}/pdf`;fetch(s,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`}}).then(e=>{if(!e.ok)throw new Error("Error en la solicitud");return e.blob()}).then(e=>{let b=window.URL.createObjectURL(e),m=document.createElement("a");m.href=b,m.download=`pedido_${this.pedidoId}.pdf`,document.body.appendChild(m),m.click(),m.remove()}).catch(e=>{console.error("Error al generar el PDF:",e)})}};c.\u0275fac=function(s){return new(s||c)(g(D))},c.\u0275cmp=v({type:c,selectors:[["app-pedido-detalle"]],decls:36,vars:14,consts:[[3,"translucent"],["slot","start"],["defaultHref","/pedidos"],[3,"fullscreen"],[1,"centrar"],[4,"ngFor","ngForOf"],["expand","block","color","primary",1,"ion-no-margin","ion-no-padding",3,"click"],["slot","header"],["slot","content",1,"ion-padding"]],template:function(s,e){s&1&&(a(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),l(3,"ion-back-button",2),i(),a(4,"ion-title"),t(5),i()()(),a(6,"ion-content",3)(7,"div",4)(8,"ion-card")(9,"ion-card-header")(10,"ion-card-title"),t(11),i(),a(12,"ion-card-subtitle"),t(13),l(14,"br"),t(15),i()(),a(16,"ion-card-content"),t(17),l(18,"br"),t(19),l(20,"br"),t(21),l(22,"br"),t(23),l(24,"br"),t(25),l(26,"br")(27,"br"),t(28),l(29,"br"),i()(),a(30,"ion-accordion-group"),E(31,J,28,16,"ion-accordion",5),i()()(),a(32,"ion-footer",4)(33,"ion-button",6),C("click",function(){return e.generarPDF()}),t(34," Generar PDF "),i(),l(35,"br"),i()),s&2&&(u("translucent",!0),n(5),r("Pedido #",e.pedidoId,""),n(),u("fullscreen",!0),n(5),h("",e.cliente.nombre," ",e.cliente.apellidos,""),n(2),r("NIF/DNI: ",e.cliente.nif,""),n(2),r("Fecha emisi\xF3n: ",e.pedidoFecha,""),n(2),r(" Email: ",e.cliente.email,""),n(2),r(" Telefono: ",e.cliente.telefono,""),n(2),r(" Direccion: ",e.cliente.direccion,""),n(2),r(" Ciudad: ",e.cliente.ciudad,""),n(2),r(" Pais: ",e.cliente.pais,""),n(3),r(" Usuario creador: ",e.usuarioCreador,""),n(3),u("ngForOf",e.detalles))},dependencies:[U,M,L,z,k,F,S,P,T,A,R,H,_,w,y,B,N,O,$,j,G],encapsulation:2});let p=c;return p})();export{Z as PedidoDetallePage};
