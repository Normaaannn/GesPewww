import"./chunk-JT42SL3Y.js";import{a as Y,b as Z}from"./chunk-DIOT67RP.js";import"./chunk-QA2ZZ3BP.js";import"./chunk-EIUGSWZD.js";import"./chunk-TW6IKH4B.js";import"./chunk-ZWHDOK3R.js";import"./chunk-4PGTP63H.js";import"./chunk-BDVXA75T.js";import"./chunk-HC6MZPB3.js";import"./chunk-I3LG7LOT.js";import"./chunk-FERD25SW.js";import"./chunk-7EU7YSXT.js";import"./chunk-LEIMCQKJ.js";import"./chunk-KKMBB4JE.js";import"./chunk-BZ2JL7UE.js";import"./chunk-5OMUW5VI.js";import"./chunk-OBXDPQ3V.js";import"./chunk-GZWEEWZ4.js";import"./chunk-MCRJI3T3.js";import"./chunk-MAJNWM2K.js";import"./chunk-5LUBTVRJ.js";import{a as h}from"./chunk-GGPG3CNO.js";import{Ab as V,B as l,Bb as z,Ca as O,D as i,Db as H,E as o,Eb as J,F as _,Hb as G,Ia as x,Ib as q,J as v,K as u,L as y,Qb as K,Rb as Q,S as c,Sb as X,T as S,U as C,V as w,X as f,Y as P,Z as b,bb as R,ga as E,ib as $,j as I,jb as W,k as U,ka as M,qb as N,r,s as T,ta as B,u as k,vb as j,wb as A,xb as D,y as d,yb as L,za as F}from"./chunk-WQB6777H.js";import"./chunk-L2GIMNSN.js";import"./chunk-7KGURMOZ.js";import"./chunk-YZINE4VV.js";import"./chunk-OITPVWB3.js";import"./chunk-YXCBSPVC.js";import"./chunk-HII7ZFLR.js";import"./chunk-7JVEMCNU.js";import"./chunk-Z65EUC5N.js";import"./chunk-4U6PRYVA.js";import"./chunk-ETCIABSX.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import"./chunk-RW4GY4BD.js";function te(m,a){if(m&1){let p=v();i(0,"ion-item",16),u("click",function(){let g=I(p).$implicit,e=y();return U(e.goToUsuarioDetalle(g))}),i(1,"ion-label")(2,"h2"),c(3),o(),i(4,"p"),c(5),o()()()}if(m&2){let p=a.$implicit;l("button",!0),r(3),w("Id: ",p.id," Username: ",p.username,""),r(2),C("Email: ",p.email,"")}}function ie(m,a){if(m&1&&(i(0,"ion-select-option",17),c(1),o()),m&2){let p=a.$implicit;l("value",p),r(),S(p)}}var Ie=(()=>{let a=class a{handleRefresh(n){setTimeout(()=>{this.loadUsuarios(this.segmentButton),n.target.complete()},2e3)}constructor(n){this.router=n,this.usuarios=[],this.searchTerm="",this.currentPage=1,this.totalPages=1,this.pageSize=20,this.pageOptions=[],this.segmentButton=1,Y({add:Z})}ionViewWillEnter(){this.loadUsuarios()}loadUsuarios(n=this.segmentButton){this.segmentButton=n;let g=localStorage.getItem("accessToken");if(!g){console.log("No se encontr\xF3 el token de acceso");return}let e="";if(this.searchTerm.trim()==="")switch(n){case 1:e=h.apiUrl+`/usuario/user/page/${this.currentPage}`;break;case 2:e=h.apiUrl+`/usuario/guest/page/${this.currentPage}`;break;case 3:e=h.apiUrl+`/usuario/page/${this.currentPage}`;break}else switch(n){case 1:e=h.apiUrl+`/usuario/buscar/user/${this.searchTerm}/page/${this.currentPage}`;break;case 2:e=h.apiUrl+`/usuario/buscar/guest/${this.searchTerm}/page/${this.currentPage}`;break;case 3:e=h.apiUrl+`/usuario/buscar/${this.searchTerm}/page/${this.currentPage}`;break}fetch(e,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`}}).then(t=>{if(!t.ok)throw new Error("Error en la solicitud");return t.json()}).then(t=>{console.log("Respuesta completa:",t),typeof t=="string"&&(t=JSON.parse(t),console.log("Convertido a JSON:",t)),Array.isArray(t)?this.usuarios=t:t&&t.content?(this.usuarios=t.content,this.totalPages=t.totalPages||1,this.pageOptions=Array.from({length:this.totalPages},(s,ee)=>ee+1)):console.warn("Formato de datos inesperado:",t)})}changePage(n){n==="prev"&&this.currentPage>1?this.currentPage--:n==="next"&&this.currentPage<this.totalPages&&this.currentPage++,this.loadUsuarios()}previousPage(){this.currentPage>1&&(this.currentPage--,this.loadUsuarios())}nextPage(){this.currentPage<this.totalPages&&(this.currentPage++,this.loadUsuarios())}goToUsuarioDetalle(n){this.router.navigate(["/usuario-detalle"],{state:{usuario:n}})}};a.\u0275fac=function(g){return new(g||a)(T(B))},a.\u0275cmp=k({type:a,selectors:[["app-usuarios"]],decls:31,vars:9,consts:[[3,"translucent"],["slot","start"],["defaultHref","/ajustes"],[3,"fullscreen"],[1,"centrar"],["slot","fixed",3,"ionRefresh"],["value","usuarios"],["value","usuarios",3,"click"],["value","invitados",3,"click"],["value","todos",3,"click"],["placeholder","Buscar por usuario...",3,"ngModelChange","ionInput","ngModel","debounce"],[3,"button","click",4,"ngFor","ngForOf"],[2,"display","flex","justify-content","center","align-items","center","margin-top","20px","margin-bottom","20px"],[3,"click","disabled"],["interface","popover",3,"ngModelChange","ionChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[3,"click","button"],[3,"value"]],template:function(g,e){g&1&&(i(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),_(3,"ion-back-button",2),o(),i(4,"ion-title")(5,"b"),c(6,"Usuarios"),o()()()(),i(7,"ion-content",3)(8,"div",4)(9,"ion-refresher",5),u("ionRefresh",function(s){return e.handleRefresh(s)}),_(10,"ion-refresher-content"),o(),i(11,"ion-segment",6)(12,"ion-segment-button",7),u("click",function(){return e.loadUsuarios(1)}),i(13,"ion-label"),c(14,"Usuarios"),o()(),i(15,"ion-segment-button",8),u("click",function(){return e.loadUsuarios(2)}),i(16,"ion-label"),c(17,"Invitados"),o()(),i(18,"ion-segment-button",9),u("click",function(){return e.loadUsuarios(3)}),i(19,"ion-label"),c(20,"Todos"),o()()(),i(21,"ion-searchbar",10),b("ngModelChange",function(s){return P(e.searchTerm,s)||(e.searchTerm=s),s}),u("ionInput",function(){return e.loadUsuarios()}),o(),i(22,"ion-list"),d(23,te,6,4,"ion-item",11),o(),i(24,"div",12)(25,"ion-button",13),u("click",function(){return e.changePage("prev")}),c(26,"\u2190"),o(),i(27,"ion-select",14),b("ngModelChange",function(s){return P(e.currentPage,s)||(e.currentPage=s),s}),u("ionChange",function(){return e.loadUsuarios()}),d(28,ie,2,2,"ion-select-option",15),o(),i(29,"ion-button",13),u("click",function(){return e.changePage("next")}),c(30,"\u2192"),o()()()()),g&2&&(l("translucent",!0),r(7),l("fullscreen",!0),r(14),f("ngModel",e.searchTerm),l("debounce",1e3),r(2),l("ngForOf",e.usuarios),r(2),l("disabled",e.currentPage===1),r(2),f("ngModel",e.currentPage),r(),l("ngForOf",e.pageOptions),r(),l("disabled",e.currentPage===e.totalPages))},dependencies:[N,j,G,q,M,E,x,F,O,$,X,J,A,D,L,V,z,K,Q,H,W,R],styles:['@charset "UTF-8";ion-select[_ngcontent-%COMP%]{max-width:120px;min-width:80px;width:auto;text-align:center}ion-segment-button[_ngcontent-%COMP%]{height:60px}']});let m=a;return m})();export{Ie as UsuariosPage};
