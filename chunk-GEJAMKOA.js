import{b as R,c as U,e as G,h as J,i as K,j as Q,k as X,l as Y,m as Z,n as $,p as ee}from"./chunk-LCM7M6OW.js";import"./chunk-EIUGSWZD.js";import"./chunk-TW6IKH4B.js";import"./chunk-ZWHDOK3R.js";import"./chunk-4PGTP63H.js";import"./chunk-BDVXA75T.js";import"./chunk-HC6MZPB3.js";import"./chunk-I3LG7LOT.js";import"./chunk-FERD25SW.js";import"./chunk-7EU7YSXT.js";import"./chunk-LEIMCQKJ.js";import"./chunk-KKMBB4JE.js";import"./chunk-BZ2JL7UE.js";import"./chunk-5OMUW5VI.js";import"./chunk-OBXDPQ3V.js";import"./chunk-GZWEEWZ4.js";import"./chunk-MCRJI3T3.js";import"./chunk-MAJNWM2K.js";import"./chunk-5LUBTVRJ.js";import{a as H}from"./chunk-GGPG3CNO.js";import{Aa as T,B as C,Ba as V,C as m,Ca as A,D as a,Da as F,E as l,Ga as B,Ha as E,Ib as D,J as I,Ja as W,Jb as q,K as g,Mb as x,Qb as j,S as u,U as w,X as h,Y as f,Z as b,j as d,jb as O,k as s,ka as y,r as n,rb as k,s as P,ta as N,u as M,wb as L,xb as z,za as S}from"./chunk-GKQ2PQVS.js";import"./chunk-L2GIMNSN.js";import"./chunk-7KGURMOZ.js";import"./chunk-YZINE4VV.js";import"./chunk-OITPVWB3.js";import"./chunk-YXCBSPVC.js";import"./chunk-HII7ZFLR.js";import"./chunk-7JVEMCNU.js";import"./chunk-Z65EUC5N.js";import"./chunk-4U6PRYVA.js";import"./chunk-ETCIABSX.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{f as v}from"./chunk-RW4GY4BD.js";var ge=(()=>{let p=class p{constructor(o,i){this.router=o,this.toastController=i,this.nombre="",this.descripcion="",this.precioNeto="",this.iva="",this.precioBruto=0,this.formSubmitted=!1}ngOnInit(){}get formInvalid(){return!this.nombre||!this.descripcion||!this.precioNeto||!this.iva}addProducto(){if(this.formSubmitted=!0,this.formInvalid)return;if(Number(this.precioNeto)<0||Number(this.precioNeto)>9999999999||Number(this.iva)<0||Number(this.iva)>99){this.presentToast("Los valores de precio neto o IVA son negativos o muy grandes.");return}if(this.tieneDecimales(this.precioNeto,2)){this.presentToast("El precio neto no puede tener mas de dos decimales.");return}if(this.tieneDecimales(this.iva,0)){this.presentToast("El iva no puede tener decimales.");return}let o=localStorage.getItem("accessToken");if(!o){console.log("No se encontr\xF3 el token de acceso");return}let i=H.apiUrl+"/producto";fetch(i,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({nombre:this.nombre,descripcion:this.descripcion,precioNeto:this.precioNeto,iva:this.iva})}).then(e=>e.text()).then(e=>{e.trim()==="Producto a\xF1adido"?this.router.navigate(["/productos"]):this.presentToast("Error en el registro: "+e)}).catch(e=>{console.error("Error en la solicitud:",e),alert("Error en la solicitud")})}cancelar(){this.router.navigate(["/productos"])}actualizarPrecioBruto(){let o=parseFloat(this.precioNeto)||0,i=parseFloat(this.iva)||0;this.precioBruto=parseFloat((o*(1+i/100)).toFixed(2))}tieneDecimales(o,i){let r=String(o).replace(",",".").split(".");return r.length<2?!1:r[1].length>i}presentToast(o){return v(this,null,function*(){yield(yield this.toastController.create({message:o,duration:2e3,position:"top"})).present()})}};p.\u0275fac=function(i){return new(i||p)(P(N),P(x))},p.\u0275cmp=M({type:p,selectors:[["app-producto-add"]],decls:25,vars:17,consts:[["clienteForm","ngForm"],[3,"translucent"],[3,"fullscreen"],[1,"centrar"],[1,"addProducto",3,"ngSubmit"],["type","text","placeholder","Nombre","name","nombre","label","Nombre","labelPlacement","floating","maxlength","40","required","",3,"ngModelChange","ngModel"],["type","text","placeholder","Descripci\xF3n","name","descripcion","label","Descripci\xF3n","labelPlacement","floating","maxlength","200","required","",3,"ngModelChange","ngModel"],["type","number","placeholder","Precio neto","name","precioNeto","label","Precio neto","labelPlacement","floating","required","",3,"ngModelChange","ngModel"],["type","number","placeholder","I.V.A.","name","iva","label","I.V.A.","labelPlacement","floating","required","",3,"ngModelChange","ngModel"],["position","stacked"],[1,"precio-bruto"],["expand","block","type","submit",1,"boton-a\xF1adir"],["expand","block",1,"boton-cancelar",3,"click"]],template:function(i,e){if(i&1){let r=I();a(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-title"),u(3,"A\xF1adir producto"),l()()(),a(4,"ion-content",2)(5,"div",3)(6,"form",4,0),g("ngSubmit",function(){return d(r),s(e.addProducto())}),a(8,"ion-item")(9,"ion-input",5),b("ngModelChange",function(t){return d(r),f(e.nombre,t)||(e.nombre=t),s(t)}),l()(),a(10,"ion-item")(11,"ion-input",6),b("ngModelChange",function(t){return d(r),f(e.descripcion,t)||(e.descripcion=t),s(t)}),l()(),a(12,"ion-item")(13,"ion-input",7),b("ngModelChange",function(t){return d(r),f(e.precioNeto,t)||(e.precioNeto=t),s(t)}),g("ngModelChange",function(){return d(r),s(e.actualizarPrecioBruto())}),l()(),a(14,"ion-item")(15,"ion-input",8),b("ngModelChange",function(t){return d(r),f(e.iva,t)||(e.iva=t),s(t)}),g("ngModelChange",function(){return d(r),s(e.actualizarPrecioBruto())}),l()(),a(16,"ion-item")(17,"ion-label",9),u(18,"Precio Bruto"),l(),a(19,"div",10),u(20),l()(),a(21,"ion-button",11),u(22," A\xF1adir producto "),l(),a(23,"ion-button",12),g("click",function(){return d(r),s(e.cancelar())}),u(24," Cancelar "),l()()()()}i&2&&(C("translucent",!0),n(4),C("fullscreen",!0),n(4),m("invalid",!e.nombre&&e.formSubmitted),n(),h("ngModel",e.nombre),n(),m("invalid",!e.descripcion&&e.formSubmitted),n(),h("ngModel",e.descripcion),n(),m("invalid",!e.precioNeto&&e.formSubmitted),n(),h("ngModel",e.precioNeto),n(),m("invalid",!e.iva&&e.formSubmitted),n(),h("ngModel",e.iva),n(5),w("",e.precioBruto," \u20AC"),n(),m("disabled",e.formInvalid))},dependencies:[k,L,D,q,y,W,F,S,T,B,E,A,V,ee,G,J,K,Q,X,Y,Z,$,R,U,j,z,O],styles:['@charset "UTF-8";.addProducto[_ngcontent-%COMP%]{padding-left:20px;padding-right:20px;padding-top:20px}.boton-a\\f1 adir[_ngcontent-%COMP%]{padding:20px}.boton-cancelar[_ngcontent-%COMP%]{padding-right:20px;padding-left:20px}.invalid[_ngcontent-%COMP%]{border:2px solid red;--ion-color: red}.error-text[_ngcontent-%COMP%]{color:red;font-size:14px;text-align:center;margin-top:5px}.disabled[_ngcontent-%COMP%]{pointer-events:auto}.precio-bruto[_ngcontent-%COMP%]{padding-top:6px;padding-bottom:6px}']});let _=p;return _})();export{ge as ProductoAddPage};
