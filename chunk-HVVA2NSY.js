import{c as Y,d as Z,e as x,f as $,h as ee,i as ie,j as oe,k as te,m as ne,n as re,o as ae,p as le}from"./chunk-T5ABTVR2.js";import"./chunk-EIUGSWZD.js";import"./chunk-TW6IKH4B.js";import"./chunk-ZWHDOK3R.js";import"./chunk-4PGTP63H.js";import"./chunk-BDVXA75T.js";import"./chunk-HC6MZPB3.js";import"./chunk-I3LG7LOT.js";import"./chunk-FERD25SW.js";import"./chunk-7EU7YSXT.js";import"./chunk-LEIMCQKJ.js";import"./chunk-KKMBB4JE.js";import"./chunk-BZ2JL7UE.js";import"./chunk-5OMUW5VI.js";import"./chunk-OBXDPQ3V.js";import"./chunk-GZWEEWZ4.js";import"./chunk-MCRJI3T3.js";import"./chunk-MAJNWM2K.js";import"./chunk-5LUBTVRJ.js";import{a as V}from"./chunk-GGPG3CNO.js";import{B as n,Ba as N,C as c,Ca as O,D as t,Da as A,E as r,Ea as L,F as E,Fa as q,G as w,H as M,Ia as j,J as S,Ja as D,K as y,Kb as U,L as C,La as R,Lb as K,Ob as Q,S as b,Sb as X,X as h,Y as u,Z as f,ha as W,j as s,k as d,la as B,lb as z,r as o,s as P,tb as G,u as T,ua as k,y as I,yb as H,zb as J}from"./chunk-37LTOCVS.js";import"./chunk-L2GIMNSN.js";import"./chunk-7KGURMOZ.js";import"./chunk-YZINE4VV.js";import"./chunk-OITPVWB3.js";import"./chunk-YXCBSPVC.js";import"./chunk-HII7ZFLR.js";import"./chunk-7JVEMCNU.js";import"./chunk-Z65EUC5N.js";import"./chunk-4U6PRYVA.js";import"./chunk-ETCIABSX.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{f as v}from"./chunk-RW4GY4BD.js";function se(p,_){p&1&&(t(0,"ion-buttons",16),E(1,"ion-back-button",17),r())}function de(p,_){if(p&1){let F=S();w(0),t(1,"ion-button",18),y("click",function(){s(F);let l=C();return d(l.activarEdicion())}),b(2," Editar "),r(),t(3,"ion-button",19),y("click",function(){s(F);let l=C();return d(l.atras())}),b(4," Atr\xE1s "),r(),M()}}function me(p,_){if(p&1&&(w(0),t(1,"ion-button",20),b(2," Guardar "),r(),E(3,"ion-alert",21),t(4,"ion-button",22),b(5," Cancelar "),r(),E(6,"ion-alert",23),M()),p&2){let F=C();o(),c("disabled",F.formInvalid),o(2),n("buttons",F.alertButtonsGuardar),o(3),n("buttons",F.alertButtonsCancelar)}}var we=(()=>{let _=class _{constructor(a,l){this.router=a,this.toastController=l,this.nombre="",this.apellidos="",this.nif="",this.email="",this.telefono="",this.direccion="",this.ciudad="",this.codigoPostal="",this.pais="",this.activo=null,this.fechaRegistro=null,this.emailValid=!0,this.formSubmitted=!1,this.modoEdicion=!1,this.nombreForm="",this.apellidosForm="",this.nifForm="",this.emailForm="",this.telefonoForm="",this.direccionForm="",this.ciudadForm="",this.codigoPostalForm="",this.paisForm="",this.alertButtonsGuardar=this.crearAlertButtons(()=>this.addInfo()),this.alertButtonsCancelar=this.crearAlertButtons(()=>this.cancelarEdicion())}ngOnInit(){this.loadInfo()}isEmailValid(){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.emailForm)}validateEmail(){this.emailValid=this.isEmailValid()}get formInvalid(){return!this.nombreForm||!this.apellidosForm||!this.nifForm||!this.emailForm||!this.emailValid||!this.telefonoForm||!this.direccionForm||!this.ciudadForm||!this.codigoPostalForm||!this.paisForm}addInfo(){if(this.formSubmitted=!0,this.formInvalid)return;this.modoEdicion=!1;let a=localStorage.getItem("accessToken");if(!a){console.log("No se encontr\xF3 el token de acceso");return}let l=V.apiUrl+"/info_empresa";fetch(l,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({nombre:this.nombreForm,apellidos:this.apellidosForm,email:this.emailForm,nif:this.nifForm,telefono:this.telefonoForm,direccion:this.direccionForm,ciudad:this.ciudadForm,codigoPostal:this.codigoPostalForm,pais:this.paisForm})}).then(e=>e.text()).then(e=>{e.trim()==="Informaci\xF3n actualizada"?(this.presentToast("Informaci\xF3n actualizada"),this.nombre=this.nombreForm,this.apellidos=this.apellidosForm,this.nif=this.nifForm,this.email=this.emailForm,this.telefono=this.telefonoForm,this.direccion=this.direccionForm,this.ciudad=this.ciudadForm,this.codigoPostal=this.codigoPostalForm,this.pais=this.paisForm,this.modoEdicion=!1):alert("Error en el registro: "+e)}).catch(e=>{console.error("Error en la solicitud:",e),alert("Error en la solicitud")})}loadInfo(){let a=localStorage.getItem("accessToken");if(!a){console.log("No se encontr\xF3 el token de acceso");return}let l=V.apiUrl+"/info_empresa";fetch(l,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`}}).then(e=>{if(!e.ok)throw new Error("Error en la solicitud");return e.json()}).then(e=>{console.log("Respuesta completa:",e),typeof e=="string"&&(e=JSON.parse(e),console.log("Convertido a JSON:",e)),e&&typeof e=="object"?(console.log("Datos de la API:",e),this.info=e,this.cargarForm()):console.warn("Formato de datos inesperado:",e)})}cargarForm(){this.info.id!==void 0&&(this.clienteID=this.info.id,this.nombre=this.info.nombre||"",this.apellidos=this.info.apellidos||"",this.nif=this.info.nif||"",this.email=this.info.email||"",this.telefono=this.info.telefono||"",this.direccion=this.info.direccion||"",this.ciudad=this.info.ciudad||"",this.codigoPostal=this.info.codigoPostal||"",this.pais=this.info.pais||"",this.activo=this.info.activo||null,this.fechaRegistro=this.info.fechaRegistro||null,this.nombreForm=this.nombre,this.apellidosForm=this.apellidos,this.nifForm=this.nif,this.emailForm=this.email,this.telefonoForm=this.telefono,this.direccionForm=this.direccion,this.ciudadForm=this.ciudad,this.codigoPostalForm=this.codigoPostal,this.paisForm=this.pais)}activarEdicion(){this.modoEdicion=!0}atras(){this.router.navigate(["/ajustes"])}cancelarEdicion(){this.modoEdicion=!1,this.nombreForm=this.nombre,this.apellidosForm=this.apellidos,this.nifForm=this.nif,this.emailForm=this.email,this.telefonoForm=this.telefono,this.direccionForm=this.direccion,this.ciudadForm=this.ciudad,this.codigoPostalForm=this.codigoPostal,this.paisForm=this.pais}presentToast(a){return v(this,null,function*(){yield(yield this.toastController.create({message:a,duration:2e3,position:"top",cssClass:"toast"})).present()})}crearAlertButtons(a){return[{text:"No",cssClass:"alert-button-cancel"},{text:"Si",cssClass:"alert-button-confirm",handler:a}]}};_.\u0275fac=function(l){return new(l||_)(P(k),P(Q))},_.\u0275cmp=T({type:_,selectors:[["app-info-empresa"]],decls:29,vars:41,consts:[["clienteForm","ngForm"],[3,"translucent"],["slot","start",4,"ngIf"],[3,"fullscreen"],[1,"centrar"],[1,"addCliente",3,"ngSubmit"],["type","text","placeholder","Nombre","name","nombre","label","Nombre","labelPlacement","floating","maxlength","60","required","",3,"ngModelChange","ngModel","readonly"],["type","text","placeholder","Apellidos","name","apellidos","label","Apellidos","labelPlacement","floating","maxlength","60","required","",3,"ngModelChange","ngModel","readonly"],["type","text","placeholder","NIF","name","nif","label","NIF","labelPlacement","floating","maxlength","15","required","",3,"ngModelChange","ngModel","readonly"],["type","email","placeholder","Correo electr\xF3nico","name","email","label","Email","labelPlacement","floating","maxlength","60","required","",3,"ngModelChange","ionInput","ngModel","readonly"],["type","text","placeholder","Tel\xE9fono","name","telefono","label","Tel\xE9fono","labelPlacement","floating","maxlength","20","required","",3,"ngModelChange","ngModel","readonly"],["type","text","placeholder","Direcci\xF3n","name","direccion","label","Direcci\xF3n","labelPlacement","floating","maxlength","100","required","",3,"ngModelChange","ngModel","readonly"],["type","text","placeholder","Ciudad","name","ciudad","label","Ciudad","labelPlacement","floating","maxlength","50","required","",3,"ngModelChange","ngModel","readonly"],["type","text","placeholder","C\xF3digo postal","name","codigoPostal","label","C\xF3digo postal","labelPlacement","floating","maxlength","10","required","",3,"ngModelChange","ngModel","readonly"],["type","text","placeholder","Pa\xEDs","name","pais","label","Pa\xEDs","labelPlacement","floating","maxlength","50","required","",3,"ngModelChange","ngModel","readonly"],[4,"ngIf"],["slot","start"],["defaultHref","/ajustes"],["expand","block",1,"boton-editar-guardar",3,"click"],["expand","block",1,"boton-atras",3,"click"],["id","guardar","expand","block",1,"boton-editar-guardar"],["trigger","guardar","type","submit","header","Vas a guardar los cambios. \xBFEst\xE1s seguro?",1,"custom-alert",3,"buttons"],["id","cancelarEdicion","expand","block",1,"boton-cancelar"],["trigger","cancelarEdicion","header","Vas a cancelar la edici\xF3n. \xBFEst\xE1s seguro?",1,"custom-alert",3,"buttons"]],template:function(l,e){if(l&1){let m=S();t(0,"ion-header",1)(1,"ion-toolbar"),I(2,se,2,0,"ion-buttons",2),t(3,"ion-title"),b(4,"Informaci\xF3n"),r()()(),t(5,"ion-content",3)(6,"div",4)(7,"form",5,0),y("ngSubmit",function(){return s(m),d(e.addInfo())}),t(9,"ion-item")(10,"ion-input",6),f("ngModelChange",function(i){return s(m),u(e.nombreForm,i)||(e.nombreForm=i),d(i)}),r()(),t(11,"ion-item")(12,"ion-input",7),f("ngModelChange",function(i){return s(m),u(e.apellidosForm,i)||(e.apellidosForm=i),d(i)}),r()(),t(13,"ion-item")(14,"ion-input",8),f("ngModelChange",function(i){return s(m),u(e.nifForm,i)||(e.nifForm=i),d(i)}),r()(),t(15,"ion-item")(16,"ion-input",9),f("ngModelChange",function(i){return s(m),u(e.emailForm,i)||(e.emailForm=i),d(i)}),y("ionInput",function(){return s(m),d(e.validateEmail())}),r()(),t(17,"ion-item")(18,"ion-input",10),f("ngModelChange",function(i){return s(m),u(e.telefonoForm,i)||(e.telefonoForm=i),d(i)}),r()(),t(19,"ion-item")(20,"ion-input",11),f("ngModelChange",function(i){return s(m),u(e.direccionForm,i)||(e.direccionForm=i),d(i)}),r()(),t(21,"ion-item")(22,"ion-input",12),f("ngModelChange",function(i){return s(m),u(e.ciudadForm,i)||(e.ciudadForm=i),d(i)}),r()(),t(23,"ion-item")(24,"ion-input",13),f("ngModelChange",function(i){return s(m),u(e.codigoPostalForm,i)||(e.codigoPostalForm=i),d(i)}),r()(),t(25,"ion-item")(26,"ion-input",14),f("ngModelChange",function(i){return s(m),u(e.paisForm,i)||(e.paisForm=i),d(i)}),r()(),I(27,de,5,0,"ng-container",15)(28,me,7,4,"ng-container",15),r()()()}l&2&&(n("translucent",!0),o(2),n("ngIf",!e.modoEdicion),o(3),n("fullscreen",!0),o(4),c("invalid",!e.nombre&&e.formSubmitted),o(),h("ngModel",e.nombreForm),n("readonly",!e.modoEdicion),o(),c("invalid",!e.apellidos&&e.formSubmitted),o(),h("ngModel",e.apellidosForm),n("readonly",!e.modoEdicion),o(),c("invalid",!e.nif&&e.formSubmitted),o(),h("ngModel",e.nifForm),n("readonly",!e.modoEdicion),o(),c("invalid",(!e.email||!e.isEmailValid())&&e.formSubmitted),o(),h("ngModel",e.emailForm),n("readonly",!e.modoEdicion),o(),c("invalid",!e.telefono&&e.formSubmitted),o(),h("ngModel",e.telefonoForm),n("readonly",!e.modoEdicion),o(),c("invalid",!e.direccion&&e.formSubmitted),o(),h("ngModel",e.direccionForm),n("readonly",!e.modoEdicion),o(),c("invalid",!e.ciudad&&e.formSubmitted),o(),h("ngModel",e.ciudadForm),n("readonly",!e.modoEdicion),o(),c("invalid",!e.codigoPostal&&e.formSubmitted),o(),h("ngModel",e.codigoPostalForm),n("readonly",!e.modoEdicion),o(),c("invalid",!e.pais&&e.formSubmitted),o(),h("ngModel",e.paisForm),n("readonly",!e.modoEdicion),o(),n("ngIf",!e.modoEdicion),o(),n("ngIf",e.modoEdicion))},dependencies:[G,H,U,K,B,W,R,q,N,O,j,D,L,A,le,Z,x,$,ee,ie,oe,te,ne,re,Y,ae,X,J,z],styles:[".addCliente[_ngcontent-%COMP%]{padding-left:20px;padding-right:20px;padding-top:20px}.boton-editar-guardar[_ngcontent-%COMP%]{padding:20px}.boton-atras[_ngcontent-%COMP%], .boton-cancelar[_ngcontent-%COMP%]{padding-right:20px;padding-left:20px}.boton-eliminar[_ngcontent-%COMP%], .boton-habilitar[_ngcontent-%COMP%]{padding:20px}.invalid[_ngcontent-%COMP%]{border:2px solid red;--ion-color: red}.error-text[_ngcontent-%COMP%]{color:red;font-size:14px;text-align:center;margin-top:5px}.disabled[_ngcontent-%COMP%]{pointer-events:auto}"]});let p=_;return p})();export{we as InfoEmpresaPage};
