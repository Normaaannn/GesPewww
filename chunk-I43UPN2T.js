import{a as D}from"./chunk-KX3QT6RN.js";import{B as b,Ba as k,C as c,Ca as I,D as r,Da as V,E as a,Ea as F,Fa as R,Ia as E,J as v,K as C,Kb as j,La as W,Lb as B,Ob as z,S as g,Sb as A,X as w,Y as f,Z as P,j as l,k as d,la as M,lb as N,r as i,s as p,sa as S,tb as O,u as y,ua as T,yb as L,zb as q}from"./chunk-37LTOCVS.js";import"./chunk-L2GIMNSN.js";import"./chunk-7KGURMOZ.js";import"./chunk-YZINE4VV.js";import"./chunk-OITPVWB3.js";import"./chunk-YXCBSPVC.js";import"./chunk-HII7ZFLR.js";import"./chunk-7JVEMCNU.js";import"./chunk-Z65EUC5N.js";import"./chunk-4U6PRYVA.js";import"./chunk-ETCIABSX.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{f as _}from"./chunk-RW4GY4BD.js";var Y=(()=>{let s=class s{constructor(n,t,e){this.router=n,this.activatedRoute=t,this.toastController=e,this.newPassword="",this.confirmPassword="",this.formSubmitted=!1,this.token=null}ngOnInit(){this.activatedRoute.queryParamMap.subscribe(n=>{this.token=n.get("token"),console.log("Token recibido:",this.token)})}get formInvalid(){return!this.newPassword||!this.confirmPassword}cambiarPass(){if(this.formSubmitted=!0,this.formInvalid)return;if(this.newPassword!==this.confirmPassword){this.presentToast("Las contrase\xF1as no coinciden");return}let n=D.apiUrl+"/usuario/reset-password";fetch(n,{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/plain"},body:JSON.stringify({token:this.token,newPassword:this.newPassword})}).then(t=>t.text()).then(t=>{t.trim()==="Contrase\xF1a actualizada"?(this.presentToast("Contrase\xF1a actualizada"),setTimeout(()=>{this.router.navigate(["/login"])},2e3)):this.presentToast("Error: "+t)}).catch(t=>{console.error("Error en la solicitud:",t),alert("Error en la solicitud")})}goToLogin(){this.router.navigate(["/login"])}presentToast(n){return _(this,null,function*(){yield(yield this.toastController.create({message:n,duration:2e3,position:"top",cssClass:"toast"})).present()})}};s.\u0275fac=function(t){return new(t||s)(p(T),p(S),p(z))},s.\u0275cmp=y({type:s,selectors:[["app-reset-password"]],decls:18,vars:13,consts:[["registerForm","ngForm"],[3,"translucent"],[3,"fullscreen"],[1,"centrar"],[1,"cambiarPass",3,"ngSubmit"],["type","text","placeholder","Token","name","token","label","Token","labelPlacement","floating","required","",3,"ngModelChange","ngModel"],["type","password","placeholder","Contrase\xF1a nueva","name","newPassword","label","Nueva contrase\xF1a","labelPlacement","floating","required","",3,"ngModelChange","ngModel"],["type","password","placeholder","Confirmar contrase\xF1a","name","confirmPassword","label","Confirmar contrase\xF1a","labelPlacement","floating","required","",3,"ngModelChange","ngModel"],["expand","block","type","submit",1,"boton-cambiar"],["expand","block",1,"boton-cambiar",3,"click"]],template:function(t,e){if(t&1){let m=v();r(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-title"),g(3,"Cambiar contrase\xF1a"),a()()(),r(4,"ion-content",2)(5,"div",3)(6,"form",4,0),C("ngSubmit",function(){return l(m),d(e.cambiarPass())}),r(8,"ion-item")(9,"ion-input",5),P("ngModelChange",function(o){return l(m),f(e.token,o)||(e.token=o),d(o)}),a()(),r(10,"ion-item")(11,"ion-input",6),P("ngModelChange",function(o){return l(m),f(e.newPassword,o)||(e.newPassword=o),d(o)}),a()(),r(12,"ion-item")(13,"ion-input",7),P("ngModelChange",function(o){return l(m),f(e.confirmPassword,o)||(e.confirmPassword=o),d(o)}),a()(),r(14,"ion-button",8),g(15,"Cambiar contrase\xF1a"),a(),r(16,"ion-button",9),C("click",function(){return l(m),d(e.goToLogin())}),g(17,"Cancelar"),a()()()()}t&2&&(b("translucent",!0),i(4),b("fullscreen",!0),i(4),c("invalid",!e.token&&e.formSubmitted),i(),w("ngModel",e.token),i(),c("invalid",!e.newPassword&&e.formSubmitted),i(),w("ngModel",e.newPassword),i(),c("invalid",!e.confirmPassword&&e.formSubmitted),i(),w("ngModel",e.confirmPassword),i(),c("disabled",e.formInvalid))},dependencies:[O,L,j,B,M,W,R,k,I,E,F,V,N,q,A],styles:[".cambiarPass[_ngcontent-%COMP%]{padding-top:20px;padding-left:20px;padding-right:20px}.invalid[_ngcontent-%COMP%]{border:2px solid red;--ion-color: red}.error-text[_ngcontent-%COMP%]{color:red;font-size:14px;text-align:center;margin-top:5px}.disabled[_ngcontent-%COMP%]{pointer-events:auto}"]});let h=s;return h})();export{Y as ResetPasswordPage};
