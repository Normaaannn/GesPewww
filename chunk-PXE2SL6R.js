import{a as h}from"./chunk-KX3QT6RN.js";import{Ab as D,B as c,Bb as M,D as r,E as o,F as l,K as g,Kb as N,La as T,Lb as P,Ob as O,S as a,U as d,aa as U,ba as E,eb as y,ha as I,ib as C,ja as x,la as v,lb as _,mb as k,r as n,s as m,tb as R,u as f,ua as B,y as p,yb as S,zb as A}from"./chunk-37LTOCVS.js";import"./chunk-L2GIMNSN.js";import"./chunk-7KGURMOZ.js";import"./chunk-YZINE4VV.js";import"./chunk-OITPVWB3.js";import"./chunk-YXCBSPVC.js";import"./chunk-HII7ZFLR.js";import"./chunk-7JVEMCNU.js";import"./chunk-Z65EUC5N.js";import"./chunk-4U6PRYVA.js";import"./chunk-ETCIABSX.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{f as b}from"./chunk-RW4GY4BD.js";function j(u,s){u&1&&(r(0,"ion-button",10),a(1,"Dar rol de usuario"),o())}function F(u,s){u&1&&(r(0,"ion-button",11),a(1,"Eliminar"),o())}var K=(()=>{let s=class s{constructor(t,i){this.router=t,this.toastController=i,this.rolUsuario=!1,this.baneado=!1,this.alertButtonsEliminarUsuario=this.crearAlertButtons(()=>this.eliminarUsuario()),this.alertButtonsDarRolUsuario=this.crearAlertButtons(()=>this.darRolUsuario())}ngOnInit(){let t=this.router.getCurrentNavigation();t!=null&&t.extras.state&&(this.usuario=t.extras.state.usuario),this.esUsuario(),this.esBaneado()}darRolUsuario(){let t=localStorage.getItem("accessToken");if(!t){console.log("No se encontr\xF3 el token de acceso");return}let i=h.apiUrl+`/usuario/${this.usuario.id}/darRolUsuario`;fetch(i,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}}).then(e=>e.text()).then(e=>{e.trim()==="Usuario activado correctamente"?(this.presentToast("Usuario activado"),this.router.navigate(["/usuarios"])):this.presentToast("Error en el registro: "+e)}).catch(e=>{console.error("Error en la solicitud:",e),alert("Error en la solicitud")})}eliminarUsuario(){let t=localStorage.getItem("accessToken");if(!t){console.log("No se encontr\xF3 el token de acceso");return}let i=h.apiUrl+`/usuario/${this.usuario.id}/banear`;fetch(i,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}}).then(e=>e.text()).then(e=>{e.trim()==="Usuario baneado correctamente"?(this.presentToast("Usuario baneado"),this.router.navigate(["/usuarios"])):this.presentToast("Error: "+e)}).catch(e=>{console.error("Error en la solicitud:",e),alert("Error en la solicitud")})}esUsuario(){this.usuario.role==="ROLE_USER"||this.usuario.role==="ROLE_ADMIN"?this.rolUsuario=!0:this.rolUsuario=!1}esBaneado(){this.usuario.role==="ROLE_BANNED"?this.baneado=!0:this.baneado=!1}presentToast(t){return b(this,null,function*(){(yield this.toastController.create({message:t,duration:2e3,position:"top",cssClass:"toast"})).present()})}cancelar(){this.router.navigate(["/usuarios"])}crearAlertButtons(t){return[{text:"No",cssClass:"alert-button-cancel"},{text:"Si",cssClass:"alert-button-confirm",handler:t}]}};s.\u0275fac=function(i){return new(i||s)(m(B),m(O))},s.\u0275cmp=f({type:s,selectors:[["app-usuario-detalle"]],decls:32,vars:13,consts:[[3,"translucent"],["slot","start"],["defaultHref","/ajustes"],[3,"fullscreen"],[1,"centrar"],["id","darRolUsuario","expand","block","color","success","class","boton",4,"ngIf"],["trigger","darRolUsuario","header","Vas a dar el rol usuario. \xBFEst\xE1s seguro?",1,"custom-alert",3,"buttons"],["id","eliminarUsuario","expand","block","color","danger","class","boton-eliminar",4,"ngIf"],["trigger","eliminarUsuario","header","Vas a eliminar al usuario. \xBFEst\xE1s seguro?",1,"custom-alert",3,"buttons"],["expand","block",1,"boton",3,"click"],["id","darRolUsuario","expand","block","color","success",1,"boton"],["id","eliminarUsuario","expand","block","color","danger",1,"boton-eliminar"]],template:function(i,e){i&1&&(r(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),l(3,"ion-back-button",2),o(),r(4,"ion-title"),a(5,"Usuario"),o()()(),r(6,"ion-content",3)(7,"div",4),l(8,"br"),r(9,"ion-list")(10,"ion-item")(11,"ion-label"),a(12),o(),l(13,"br"),o(),r(14,"ion-item")(15,"ion-label"),a(16),o(),l(17,"br"),o(),r(18,"ion-item")(19,"ion-label"),a(20),U(21,"date"),o(),l(22,"br"),o(),r(23,"ion-item")(24,"ion-label"),a(25),o()()(),p(26,j,2,0,"ion-button",5),l(27,"ion-alert",6),p(28,F,2,0,"ion-button",7),l(29,"ion-alert",8),r(30,"ion-button",9),g("click",function(){return e.cancelar()}),a(31,"Atr\xE1s"),o()()()),i&2&&(c("translucent",!0),n(6),c("fullscreen",!0),n(6),d("Usuario: ",e.usuario.username,""),n(4),d("Email: ",e.usuario.email,""),n(4),d("Fecha de registro: ",E(21,10,e.usuario.fechaRegistro,"dd-MM-yyyy"),""),n(5),d("Rol: ",e.usuario.role,""),n(),c("ngIf",!e.rolUsuario),n(),c("buttons",e.alertButtonsDarRolUsuario),n(),c("ngIf",!e.baneado),n(),c("buttons",e.alertButtonsEliminarUsuario))},dependencies:[R,S,N,P,v,I,x,T,k,y,D,_,C,M,A],styles:[".boton[_ngcontent-%COMP%]{padding:20px 20px 0}.boton-eliminar[_ngcontent-%COMP%]{padding-left:20px;padding-right:20px;padding-top:20px}"]});let u=s;return u})();export{K as UsuarioDetallePage};
