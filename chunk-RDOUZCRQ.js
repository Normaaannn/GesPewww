import{b as Q,c as X,d as Y,e as Z,f as $,h as ee,i as te,j as oe,k as ie,m as re,n as ne,o as ae,p as le}from"./chunk-QA2ZZ3BP.js";import"./chunk-EIUGSWZD.js";import"./chunk-TW6IKH4B.js";import"./chunk-ZWHDOK3R.js";import"./chunk-4PGTP63H.js";import"./chunk-BDVXA75T.js";import"./chunk-HC6MZPB3.js";import"./chunk-I3LG7LOT.js";import"./chunk-FERD25SW.js";import"./chunk-7EU7YSXT.js";import"./chunk-LEIMCQKJ.js";import"./chunk-KKMBB4JE.js";import"./chunk-BZ2JL7UE.js";import"./chunk-5OMUW5VI.js";import"./chunk-OBXDPQ3V.js";import"./chunk-GZWEEWZ4.js";import"./chunk-MCRJI3T3.js";import"./chunk-MAJNWM2K.js";import"./chunk-5LUBTVRJ.js";import{a as I}from"./chunk-GGPG3CNO.js";import{Aa as D,B as n,Ba as W,C as h,Ca as A,D as l,Da as O,E as s,F as b,G as S,Ga as H,H as M,Hb as G,Ia as z,Ib as U,J as T,K as E,L as _,Lb as J,Pb as K,S as p,X as f,Y as P,Z as C,ha as w,ib as L,j as u,k as m,ka as B,qb as j,r as o,s as F,ta as V,u as N,vb as q,wb as R,y,za as k}from"./chunk-WQB6777H.js";import"./chunk-L2GIMNSN.js";import"./chunk-7KGURMOZ.js";import"./chunk-YZINE4VV.js";import"./chunk-OITPVWB3.js";import"./chunk-YXCBSPVC.js";import"./chunk-HII7ZFLR.js";import"./chunk-7JVEMCNU.js";import"./chunk-Z65EUC5N.js";import"./chunk-4U6PRYVA.js";import"./chunk-ETCIABSX.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{f as x}from"./chunk-RW4GY4BD.js";function se(i,d){i&1&&(l(0,"ion-buttons",12),b(1,"ion-back-button",13),s())}function ce(i,d){if(i&1){let c=T();S(0),l(1,"ion-button",14),E("click",function(){u(c);let a=_();return m(a.activarEdicion())}),p(2," Editar producto "),s(),l(3,"ion-button",15),E("click",function(){u(c);let a=_();return m(a.atras())}),p(4," Atr\xE1s "),s(),M()}}function de(i,d){i&1&&(l(0,"ion-button",24),p(1," Eliminar "),s())}function ue(i,d){if(i&1&&b(0,"ion-alert",25),i&2){let c=_(2);n("buttons",c.alertButtonsEliminar)}}function me(i,d){i&1&&(l(0,"ion-button",26),p(1," Habilitar "),s())}function pe(i,d){if(i&1&&b(0,"ion-alert",27),i&2){let c=_(2);n("buttons",c.alertButtonsHabilitar)}}function ge(i,d){if(i&1&&(S(0),l(1,"ion-button",16),p(2," Guardar "),s(),b(3,"ion-alert",17),l(4,"ion-button",18),p(5," Cancelar "),s(),b(6,"ion-alert",19),y(7,de,2,0,"ion-button",20)(8,ue,1,1,"ion-alert",21)(9,me,2,0,"ion-button",22)(10,pe,1,1,"ion-alert",23),M()),i&2){let c=_();o(),h("disabled",c.formInvalid),o(2),n("buttons",c.alertButtonsGuardar),o(3),n("buttons",c.alertButtonsCancelar),o(),n("ngIf",c.activo),o(),n("ngIf",c.activo),o(),n("ngIf",!c.activo),o(),n("ngIf",!c.activo)}}var xe=(()=>{let d=class d{constructor(t,a){this.router=t,this.toastController=a,this.nombre="",this.descripcion="",this.precioNeto="",this.iva="",this.precioBruto="",this.activo=null,this.fechaRegistro=null,this.formSubmitted=!1,this.modoEdicion=!1,this.nombreForm="",this.descripcionForm="",this.precioNetoForm="",this.ivaForm="",this.alertButtonsEliminar=[{text:"No",cssClass:"alert-button-cancel"},{text:"Si",cssClass:"alert-button-confirm",handler:()=>{this.eliminarProducto()}}],this.alertButtonsHabilitar=[{text:"No",cssClass:"alert-button-cancel"},{text:"Si",cssClass:"alert-button-confirm",handler:()=>{this.habilitarProducto()}}],this.alertButtonsGuardar=[{text:"No",cssClass:"alert-button-cancel"},{text:"Si",cssClass:"alert-button-confirm",handler:()=>{this.updateProducto()}}],this.alertButtonsCancelar=[{text:"No",cssClass:"alert-button-cancel"},{text:"Si",cssClass:"alert-button-confirm",handler:()=>{this.cancelarEdicion()}}]}ngOnInit(){let t=this.router.getCurrentNavigation();t!=null&&t.extras.state&&(this.producto=t.extras.state.producto,this.productoID=this.producto.id,this.nombre=this.producto.nombre||"",this.descripcion=this.producto.descripcion||"",this.precioNeto=this.producto.precioNeto||"",this.iva=this.producto.iva||"",this.activo=this.producto.activo||null,this.fechaRegistro=this.producto.fechaRegistro||null,this.calcularPrecioBruto(),this.nombreForm=this.nombre,this.descripcionForm=this.descripcion,this.precioNetoForm=this.precioNeto,this.ivaForm=this.iva)}get formInvalid(){return!this.nombreForm||!this.descripcionForm||!this.precioNetoForm||!this.ivaForm}calcularPrecioBruto(){this.precioBruto=(parseFloat(this.precioNeto)*(1+parseFloat(this.iva)/100)).toString()}updateProducto(){if(this.formSubmitted=!0,this.formInvalid)return;let t=localStorage.getItem("accessToken");if(!t){console.log("No se encontr\xF3 el token de acceso");return}let a=I.apiUrl+`/producto/${this.productoID}`;fetch(a,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({nombre:this.nombreForm,descripcion:this.descripcionForm,precioNeto:this.precioNetoForm,iva:this.ivaForm})}).then(e=>e.text()).then(e=>{e.trim()==="Producto actualizado"?(this.presentToast("Producto actualizado"),this.nombre=this.nombreForm,this.descripcion=this.descripcionForm,this.precioNeto=this.precioNetoForm,this.iva=this.ivaForm,this.modoEdicion=!1):this.presentToast("Error en el registro: "+e)}).catch(e=>{console.error("Error en la solicitud:",e),alert("Error en la solicitud")})}activarEdicion(){this.modoEdicion=!0}atras(){this.router.navigate(["/productos"])}cancelarEdicion(){this.modoEdicion=!1,this.nombreForm=this.nombre,this.descripcionForm=this.descripcion,this.precioNetoForm=this.precioNeto,this.ivaForm=this.iva}eliminarProducto(){let t=localStorage.getItem("accessToken");if(!t){console.log("No se encontr\xF3 el token de acceso");return}let a=I.apiUrl+`/producto/${this.productoID}/desactivar`;fetch(a,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}}).then(e=>e.text()).then(e=>{e.trim()==="Producto desactivado correctamente"?(this.presentToast("Producto eliminado"),this.router.navigate(["/productos"])):this.presentToast("Error en el registro: "+e)}).catch(e=>{console.error("Error en la solicitud:",e),alert("Error en la solicitud")})}habilitarProducto(){let t=localStorage.getItem("accessToken");if(!t){console.log("No se encontr\xF3 el token de acceso");return}let a=I.apiUrl+`/producto/${this.productoID}/activar`;fetch(a,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}}).then(e=>e.text()).then(e=>{e.trim()==="Producto activado correctamente"?(this.presentToast("Producto habilitado"),this.router.navigate(["/productos"])):this.presentToast("Error en el registro: "+e)}).catch(e=>{console.error("Error en la solicitud:",e),alert("Error en la solicitud")})}presentToast(t){return x(this,null,function*(){yield(yield this.toastController.create({message:t,duration:2e3,position:"top"})).present()})}};d.\u0275fac=function(a){return new(a||d)(F(V),F(J))},d.\u0275cmp=N({type:d,selectors:[["app-producto-detalle"]],decls:22,vars:22,consts:[["clienteForm","ngForm"],[3,"translucent"],["slot","start",4,"ngIf"],[3,"fullscreen"],[1,"centrar"],[1,"updateProducto",3,"ngSubmit"],["type","text","placeholder","Nombre","name","nombre","label","Nombre","labelPlacement","floating","required","",3,"ngModelChange","ngModel","readonly"],["type","text","placeholder","Descripci\xF3n","name","descripcion","label","Descripci\xF3n","labelPlacement","floating","required","",3,"ngModelChange","ngModel","readonly"],["type","number","placeholder","Precio neto","name","precioNeto","label","Precio neto","labelPlacement","floating","required","",3,"ngModelChange","ngModel","readonly"],["type","number","placeholder","I.V.A.","name","iva","label","I.V.A.","labelPlacement","floating","required","",3,"ngModelChange","ngModel","readonly"],["type","text","readonly","","placeholder","Precio bruto","name","precioBruto","label","Precio Bruto","labelPlacement","floating",3,"ngModelChange","ngModel"],[4,"ngIf"],["slot","start"],["defaultHref","/productos"],["expand","block",1,"boton-editar-guardar",3,"click"],["expand","block",1,"boton-atras",3,"click"],["id","guardar","expand","block",1,"boton-editar-guardar"],["trigger","guardar","type","submit","header","Vas a guardar los cambios. \xBFEst\xE1s seguro?",1,"custom-alert",3,"buttons"],["id","cancelarEdicion","expand","block",1,"boton-cancelar"],["trigger","cancelarEdicion","header","Vas a cancelar la edici\xF3n. \xBFEst\xE1s seguro?",1,"custom-alert",3,"buttons"],["id","eliminar","expand","block","color","danger","class","boton-eliminar",4,"ngIf"],["trigger","eliminar","class","custom-alert","header","Vas a eliminar el producto. \xBFEst\xE1s seguro?",3,"buttons",4,"ngIf"],["id","habilitar","expand","block","color","success","class","boton-habilitar",4,"ngIf"],["trigger","habilitar","class","custom-alert","header","Vas a habilitar el producto. \xBFEst\xE1s seguro?",3,"buttons",4,"ngIf"],["id","eliminar","expand","block","color","danger",1,"boton-eliminar"],["trigger","eliminar","header","Vas a eliminar el producto. \xBFEst\xE1s seguro?",1,"custom-alert",3,"buttons"],["id","habilitar","expand","block","color","success",1,"boton-habilitar"],["trigger","habilitar","header","Vas a habilitar el producto. \xBFEst\xE1s seguro?",1,"custom-alert",3,"buttons"]],template:function(a,e){if(a&1){let g=T();l(0,"ion-header",1)(1,"ion-toolbar"),y(2,se,2,0,"ion-buttons",2),l(3,"ion-title"),p(4,"Producto"),s()()(),l(5,"ion-content",3)(6,"div",4)(7,"form",5,0),E("ngSubmit",function(){return u(g),m(e.updateProducto())}),l(9,"ion-item")(10,"ion-input",6),C("ngModelChange",function(r){return u(g),P(e.nombreForm,r)||(e.nombreForm=r),m(r)}),s()(),l(11,"ion-item")(12,"ion-input",7),C("ngModelChange",function(r){return u(g),P(e.descripcionForm,r)||(e.descripcionForm=r),m(r)}),s()(),l(13,"ion-item")(14,"ion-input",8),C("ngModelChange",function(r){return u(g),P(e.precioNetoForm,r)||(e.precioNetoForm=r),m(r)}),s()(),l(15,"ion-item")(16,"ion-input",9),C("ngModelChange",function(r){return u(g),P(e.ivaForm,r)||(e.ivaForm=r),m(r)}),s()(),l(17,"ion-item")(18,"ion-input",10),C("ngModelChange",function(r){return u(g),P(e.precioBruto,r)||(e.precioBruto=r),m(r)}),s(),p(19,"\u20AC "),s(),y(20,ce,5,0,"ng-container",11)(21,ge,11,8,"ng-container",11),s()()()}a&2&&(n("translucent",!0),o(2),n("ngIf",!e.modoEdicion),o(3),n("fullscreen",!0),o(4),h("invalid",!e.nombre&&e.formSubmitted),o(),f("ngModel",e.nombreForm),n("readonly",!e.modoEdicion),o(),h("invalid",!e.descripcion&&e.formSubmitted),o(),f("ngModel",e.descripcionForm),n("readonly",!e.modoEdicion),o(),h("invalid",!e.precioNeto&&e.formSubmitted),o(),f("ngModel",e.precioNetoForm),n("readonly",!e.modoEdicion),o(),h("invalid",!e.iva&&e.formSubmitted),o(),f("ngModel",e.ivaForm),n("readonly",!e.modoEdicion),o(2),f("ngModel",e.precioBruto),o(2),n("ngIf",!e.modoEdicion),o(),n("ngIf",e.modoEdicion))},dependencies:[j,q,G,U,B,w,z,O,k,D,H,A,W,le,Y,Z,$,ee,te,oe,ie,re,ne,Q,X,ae,K,R,L],styles:[".updateProducto[_ngcontent-%COMP%]{padding-left:20px;padding-right:20px;padding-top:20px}.boton-editar-guardar[_ngcontent-%COMP%]{padding:20px}.boton-atras[_ngcontent-%COMP%], .boton-cancelar[_ngcontent-%COMP%]{padding-right:20px;padding-left:20px}.boton-eliminar[_ngcontent-%COMP%], .boton-habilitar[_ngcontent-%COMP%]{padding:20px}.invalid[_ngcontent-%COMP%]{border:2px solid red;--ion-color: red}.error-text[_ngcontent-%COMP%]{color:red;font-size:14px;text-align:center;margin-top:5px}.disabled[_ngcontent-%COMP%]{pointer-events:auto}"]});let i=d;return i})();export{xe as ProductoDetallePage};
