import{a as p}from"./chunk-GGPG3CNO.js";import{B as u,D as i,E as r,F as l,Fb as D,Gb as A,Ha as x,Jb as M,K as g,S as a,U as m,ab as v,eb as C,ga as U,hb as T,ib as k,ja as E,pb as S,r as n,s as d,sa as I,u as b,ub as R,vb as y,wb as B,xb as _,y as f}from"./chunk-GOUZPZED.js";import"./chunk-L2GIMNSN.js";import"./chunk-7KGURMOZ.js";import"./chunk-YZINE4VV.js";import"./chunk-OITPVWB3.js";import"./chunk-YXCBSPVC.js";import"./chunk-HII7ZFLR.js";import"./chunk-7JVEMCNU.js";import"./chunk-Z65EUC5N.js";import"./chunk-4U6PRYVA.js";import"./chunk-ETCIABSX.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{f as h}from"./chunk-RW4GY4BD.js";function N(c,s){c&1&&(i(0,"ion-button",10),a(1,"Dar rol de usuario"),r())}var V=(()=>{let s=class s{constructor(e,o){this.router=e,this.toastController=o,this.rolUsuario=!1,this.alertButtonsEliminarUsuario=[{text:"No",cssClass:"alert-button-cancel"},{text:"Si",cssClass:"alert-button-confirm",handler:()=>{this.eliminarUsuario()}}],this.alertButtonsDarRolUsuario=[{text:"No",cssClass:"alert-button-cancel"},{text:"Si",cssClass:"alert-button-confirm",handler:()=>{this.darRolUsuario()}}]}ngOnInit(){let e=this.router.getCurrentNavigation();e!=null&&e.extras.state&&(this.usuario=e.extras.state.usuario),this.esUsuario()}darRolUsuario(){let e=localStorage.getItem("accessToken");if(!e){console.log("No se encontr\xF3 el token de acceso");return}let o=p.apiUrl+`/usuario/${this.usuario.id}/darRolUsuario`;fetch(o,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}}).then(t=>t.text()).then(t=>{t.trim()==="Usuario activado correctamente"?(this.presentToast("Usuario activado"),this.router.navigate(["/usuarios"])):this.presentToast("Error en el registro: "+t)}).catch(t=>{console.error("Error en la solicitud:",t),alert("Error en la solicitud")})}eliminarUsuario(){let e=localStorage.getItem("accessToken");if(!e){console.log("No se encontr\xF3 el token de acceso");return}let o=p.apiUrl+`/usuario/${this.usuario.id}/banear`;fetch(o,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}}).then(t=>t.text()).then(t=>{t.trim()==="Usuario baneado correctamente"?(this.presentToast("Usuario baneado"),this.router.navigate(["/usuarios"])):this.presentToast("Error: "+t)}).catch(t=>{console.error("Error en la solicitud:",t),alert("Error en la solicitud")})}esUsuario(){this.usuario.role==="ROLE_USER"||this.usuario.role==="ROLE_ADMIN"?this.rolUsuario=!0:this.rolUsuario=!1}presentToast(e){return h(this,null,function*(){(yield this.toastController.create({message:e,duration:2e3,position:"top",cssClass:"custom-toast"})).present()})}cancelar(){this.router.navigate(["/usuarios"])}};s.\u0275fac=function(o){return new(o||s)(d(I),d(M))},s.\u0275cmp=b({type:s,selectors:[["app-usuario-detalle"]],decls:28,vars:8,consts:[[3,"translucent"],["slot","start"],["defaultHref","/ajustes"],[3,"fullscreen"],[1,"centrar"],["id","darRolUsuario","expand","block","color","success","class","boton",4,"ngIf"],["trigger","darRolUsuario","header","Vas a dar el rol usuario. \xBFEst\xE1s seguro?",1,"custom-alert",3,"buttons"],["id","eliminarUsuario","expand","block","color","danger",1,"boton-eliminar"],["trigger","eliminarUsuario","header","Vas a eliminar al usuario. \xBFEst\xE1s seguro?",1,"custom-alert",3,"buttons"],["expand","block",1,"boton",3,"click"],["id","darRolUsuario","expand","block","color","success",1,"boton"]],template:function(o,t){o&1&&(i(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),l(3,"ion-back-button",2),r(),i(4,"ion-title"),a(5,"Usuario"),r()()(),i(6,"ion-content",3)(7,"div",4),l(8,"br"),i(9,"ion-list")(10,"ion-item")(11,"ion-label"),a(12),r(),l(13,"br"),r(),i(14,"ion-item")(15,"ion-label"),a(16),r(),l(17,"br"),r(),i(18,"ion-item")(19,"ion-label"),a(20),r()()(),f(21,N,2,0,"ion-button",5),l(22,"ion-alert",6),i(23,"ion-button",7),a(24,"Eliminar"),r(),l(25,"ion-alert",8),i(26,"ion-button",9),g("click",function(){return t.cancelar()}),a(27,"Atr\xE1s"),r()()()),o&2&&(u("translucent",!0),n(6),u("fullscreen",!0),n(6),m("Usuario: ",t.usuario.username,""),n(4),m("Email: ",t.usuario.email,""),n(4),m("Rol: ",t.usuario.role,""),n(),u("ngIf",!t.rolUsuario),n(),u("buttons",t.alertButtonsDarRolUsuario),n(3),u("buttons",t.alertButtonsEliminarUsuario))},dependencies:[S,R,D,A,E,U,x,k,v,B,T,C,_,y],styles:[".boton[_ngcontent-%COMP%]{padding:20px}.boton-eliminar[_ngcontent-%COMP%]{padding-left:20px;padding-right:20px}"]});let c=s;return c})();export{V as UsuarioDetallePage};
