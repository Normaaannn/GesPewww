import{c as X,d as Y,e as Z,f as $,h as ee,i as ie,j as te,k as oe,m as ne,n as ae,o as re,p as le}from"./chunk-T5ABTVR2.js";import"./chunk-EIUGSWZD.js";import"./chunk-TW6IKH4B.js";import"./chunk-ZWHDOK3R.js";import"./chunk-4PGTP63H.js";import"./chunk-BDVXA75T.js";import"./chunk-HC6MZPB3.js";import"./chunk-I3LG7LOT.js";import"./chunk-FERD25SW.js";import"./chunk-7EU7YSXT.js";import"./chunk-LEIMCQKJ.js";import"./chunk-KKMBB4JE.js";import"./chunk-BZ2JL7UE.js";import"./chunk-5OMUW5VI.js";import"./chunk-OBXDPQ3V.js";import"./chunk-GZWEEWZ4.js";import"./chunk-MCRJI3T3.js";import"./chunk-MAJNWM2K.js";import"./chunk-5LUBTVRJ.js";import{a as M}from"./chunk-GGPG3CNO.js";import{B as n,Ba as k,C as p,Ca as x,D as r,Da as N,E as l,Ea as A,F,Fa as L,G as w,H as S,Ia as O,J as v,Ja as q,K as P,Kb as U,L as y,La as H,Lb as J,Ob as K,S as C,Sb as Q,X as f,Y as _,Z as b,ha as B,j as m,k as c,la as D,lb as R,r as t,s as I,tb as z,u as V,ua as W,y as E,yb as j,zb as G}from"./chunk-37LTOCVS.js";import"./chunk-L2GIMNSN.js";import"./chunk-7KGURMOZ.js";import"./chunk-YZINE4VV.js";import"./chunk-OITPVWB3.js";import"./chunk-YXCBSPVC.js";import"./chunk-HII7ZFLR.js";import"./chunk-7JVEMCNU.js";import"./chunk-Z65EUC5N.js";import"./chunk-4U6PRYVA.js";import"./chunk-ETCIABSX.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{f as T}from"./chunk-RW4GY4BD.js";function se(a,u){a&1&&(r(0,"ion-buttons",16),F(1,"ion-back-button",17),l())}function de(a,u){if(a&1){let d=v();w(0),r(1,"ion-button",18),P("click",function(){m(d);let s=y();return c(s.activarEdicion())}),C(2," Editar cliente "),l(),r(3,"ion-button",19),P("click",function(){m(d);let s=y();return c(s.atras())}),C(4," Atr\xE1s "),l(),S()}}function me(a,u){a&1&&(r(0,"ion-button",28),C(1," Eliminar "),l())}function ce(a,u){if(a&1&&F(0,"ion-alert",29),a&2){let d=y(2);n("buttons",d.alertButtonsEliminar)}}function ue(a,u){a&1&&(r(0,"ion-button",30),C(1," Habilitar "),l())}function he(a,u){if(a&1&&F(0,"ion-alert",31),a&2){let d=y(2);n("buttons",d.alertButtonsHabilitar)}}function pe(a,u){if(a&1&&(w(0),r(1,"ion-button",20),C(2," Guardar "),l(),F(3,"ion-alert",21),r(4,"ion-button",22),C(5," Cancelar "),l(),F(6,"ion-alert",23),E(7,me,2,0,"ion-button",24)(8,ce,1,1,"ion-alert",25)(9,ue,2,0,"ion-button",26)(10,he,1,1,"ion-alert",27),S()),a&2){let d=y();t(),p("disabled",d.formInvalid),t(2),n("buttons",d.alertButtonsGuardar),t(3),n("buttons",d.alertButtonsCancelar),t(),n("ngIf",d.activo),t(),n("ngIf",d.activo),t(),n("ngIf",!d.activo),t(),n("ngIf",!d.activo)}}var Te=(()=>{let u=class u{constructor(o,s){this.router=o,this.toastController=s,this.nombre="",this.apellidos="",this.nif="",this.email="",this.telefono="",this.direccion="",this.ciudad="",this.codigoPostal="",this.pais="",this.activo=null,this.fechaRegistro=null,this.emailValid=!0,this.formSubmitted=!1,this.modoEdicion=!1,this.nombreForm="",this.apellidosForm="",this.nifForm="",this.emailForm="",this.telefonoForm="",this.direccionForm="",this.ciudadForm="",this.codigoPostalForm="",this.paisForm="",this.alertButtonsEliminar=this.crearAlertButtons(()=>this.eliminarCliente()),this.alertButtonsHabilitar=this.crearAlertButtons(()=>this.habilitarCliente()),this.alertButtonsGuardar=this.crearAlertButtons(()=>this.updateCliente()),this.alertButtonsCancelar=this.crearAlertButtons(()=>this.cancelarEdicion())}ngOnInit(){let o=this.router.getCurrentNavigation();o!=null&&o.extras.state&&(this.cliente=o.extras.state.cliente,this.clienteID=this.cliente.id,this.nombre=this.cliente.nombre||"",this.apellidos=this.cliente.apellidos||"",this.nif=this.cliente.nif||"",this.email=this.cliente.email||"",this.telefono=this.cliente.telefono||"",this.direccion=this.cliente.direccion||"",this.ciudad=this.cliente.ciudad||"",this.codigoPostal=this.cliente.codigoPostal||"",this.pais=this.cliente.pais||"",this.activo=this.cliente.activo||null,this.fechaRegistro=this.cliente.fechaRegistro||null,this.nombreForm=this.nombre,this.apellidosForm=this.apellidos,this.nifForm=this.nif,this.emailForm=this.email,this.telefonoForm=this.telefono,this.direccionForm=this.direccion,this.ciudadForm=this.ciudad,this.codigoPostalForm=this.codigoPostal,this.paisForm=this.pais)}isEmailValid(){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.emailForm)}validateEmail(){this.emailValid=this.isEmailValid()}get formInvalid(){return!this.nombreForm||!this.apellidosForm||!this.nifForm||!this.emailForm||!this.emailValid||!this.telefonoForm||!this.direccionForm||!this.ciudadForm||!this.codigoPostalForm||!this.paisForm}updateCliente(){if(this.formSubmitted=!0,this.formInvalid)return;this.modoEdicion=!1;let o=localStorage.getItem("accessToken");if(!o){console.log("No se encontr\xF3 el token de acceso");return}let s=M.apiUrl+`/cliente/${this.clienteID}`;fetch(s,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({nombre:this.nombreForm,apellidos:this.apellidosForm,email:this.emailForm,nif:this.nifForm,telefono:this.telefonoForm,direccion:this.direccionForm,ciudad:this.ciudadForm,codigoPostal:this.codigoPostalForm,pais:this.paisForm})}).then(e=>e.text()).then(e=>{e.trim()==="Cliente actualizado"?(this.presentToast("Cliente actualizado"),this.nombre=this.nombreForm,this.apellidos=this.apellidosForm,this.nif=this.nifForm,this.email=this.emailForm,this.telefono=this.telefonoForm,this.direccion=this.direccionForm,this.ciudad=this.ciudadForm,this.codigoPostal=this.codigoPostalForm,this.pais=this.paisForm,this.modoEdicion=!1):this.presentToast("Error en el registro: "+e)}).catch(e=>{console.error("Error en la solicitud:",e),alert("Error en la solicitud")})}activarEdicion(){this.modoEdicion=!0}atras(){this.router.navigate(["/clientes"])}cancelarEdicion(){this.modoEdicion=!1,this.nombreForm=this.nombre,this.apellidosForm=this.apellidos,this.nifForm=this.nif,this.emailForm=this.email,this.telefonoForm=this.telefono,this.direccionForm=this.direccion,this.ciudadForm=this.ciudad,this.codigoPostalForm=this.codigoPostal,this.paisForm=this.pais}eliminarCliente(){let o=localStorage.getItem("accessToken");if(!o){console.log("No se encontr\xF3 el token de acceso");return}let s=M.apiUrl+`/cliente/${this.clienteID}/desactivar`;fetch(s,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`}}).then(e=>e.text()).then(e=>{e.trim()==="Cliente desactivado correctamente"?(this.presentToast("Cliente eliminado"),this.router.navigate(["/clientes"])):this.presentToast("Error en el registro: "+e)}).catch(e=>{console.error("Error en la solicitud:",e),alert("Error en la solicitud")})}habilitarCliente(){let o=localStorage.getItem("accessToken");if(!o){console.log("No se encontr\xF3 el token de acceso");return}let s=M.apiUrl+`/cliente/${this.clienteID}/activar`;fetch(s,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`}}).then(e=>e.text()).then(e=>{e.trim()==="Cliente activado correctamente"?(this.presentToast("Cliente habilitado"),this.router.navigate(["/clientes"])):this.presentToast("Error en el registro: "+e)}).catch(e=>{console.error("Error en la solicitud:",e),alert("Error en la solicitud")})}presentToast(o){return T(this,null,function*(){yield(yield this.toastController.create({message:o,duration:2e3,position:"top",cssClass:"toast"})).present()})}crearAlertButtons(o){return[{text:"No",cssClass:"alert-button-cancel"},{text:"Si",cssClass:"alert-button-confirm",handler:o}]}};u.\u0275fac=function(s){return new(s||u)(I(W),I(K))},u.\u0275cmp=V({type:u,selectors:[["app-cliente-detalle"]],decls:29,vars:41,consts:[["clienteForm","ngForm"],[3,"translucent"],["slot","start",4,"ngIf"],[3,"fullscreen"],[1,"centrar"],[1,"updateCliente",3,"ngSubmit"],["type","text","placeholder","Nombre","name","nombre","label","Nombre","labelPlacement","floating","maxlength","60","required","",3,"ngModelChange","ngModel","readonly"],["type","text","placeholder","Apellidos","name","apellidos","label","Apellidos","labelPlacement","floating","maxlength","60","required","",3,"ngModelChange","ngModel","readonly"],["type","text","placeholder","NIF","name","nif","label","NIF","labelPlacement","floating","maxlength","15","required","",3,"ngModelChange","ngModel","readonly"],["type","email","placeholder","Correo electr\xF3nico","name","email","label","Email","labelPlacement","floating","maxlength","60","required","",3,"ngModelChange","ionInput","ngModel","readonly"],["type","text","placeholder","Tel\xE9fono","name","telefono","label","Tel\xE9fono","labelPlacement","floating","maxlength","20","required","",3,"ngModelChange","ngModel","readonly"],["type","text","placeholder","Direcci\xF3n","name","direccion","label","Direcci\xF3n","labelPlacement","floating","maxlength","100","required","",3,"ngModelChange","ngModel","readonly"],["type","text","placeholder","Ciudad","name","ciudad","label","Ciudad","labelPlacement","floating","maxlength","50","required","",3,"ngModelChange","ngModel","readonly"],["type","text","placeholder","C\xF3digo postal","name","codigoPostal","label","C\xF3digo postal","labelPlacement","floating","maxlength","10","required","",3,"ngModelChange","ngModel","readonly"],["type","text","placeholder","Pa\xEDs","name","pais","label","Pa\xEDs","labelPlacement","floating","maxlength","50","required","",3,"ngModelChange","ngModel","readonly"],[4,"ngIf"],["slot","start"],["defaultHref","/clientes"],["expand","block",1,"boton-editar-guardar",3,"click"],["expand","block",1,"boton-atras",3,"click"],["id","guardar","expand","block",1,"boton-editar-guardar"],["trigger","guardar","type","submit","header","Vas a guardar los cambios. \xBFEst\xE1s seguro?",1,"custom-alert",3,"buttons"],["id","cancelarEdicion","expand","block",1,"boton-cancelar"],["trigger","cancelarEdicion","header","Vas a cancelar la edici\xF3n. \xBFEst\xE1s seguro?",1,"custom-alert",3,"buttons"],["id","eliminar","expand","block","color","danger","class","boton-eliminar",4,"ngIf"],["trigger","eliminar","class","custom-alert","header","Vas a eliminar el cliente. \xBFEst\xE1s seguro?",3,"buttons",4,"ngIf"],["id","habilitar","expand","block","color","success","class","boton-habilitar",4,"ngIf"],["trigger","habilitar","class","custom-alert","header","Vas a habilitar el cliente. \xBFEst\xE1s seguro?",3,"buttons",4,"ngIf"],["id","eliminar","expand","block","color","danger",1,"boton-eliminar"],["trigger","eliminar","header","Vas a eliminar el cliente. \xBFEst\xE1s seguro?",1,"custom-alert",3,"buttons"],["id","habilitar","expand","block","color","success",1,"boton-habilitar"],["trigger","habilitar","header","Vas a habilitar el cliente. \xBFEst\xE1s seguro?",1,"custom-alert",3,"buttons"]],template:function(s,e){if(s&1){let h=v();r(0,"ion-header",1)(1,"ion-toolbar"),E(2,se,2,0,"ion-buttons",2),r(3,"ion-title"),C(4,"Cliente"),l()()(),r(5,"ion-content",3)(6,"div",4)(7,"form",5,0),P("ngSubmit",function(){return m(h),c(e.updateCliente())}),r(9,"ion-item")(10,"ion-input",6),b("ngModelChange",function(i){return m(h),_(e.nombreForm,i)||(e.nombreForm=i),c(i)}),l()(),r(11,"ion-item")(12,"ion-input",7),b("ngModelChange",function(i){return m(h),_(e.apellidosForm,i)||(e.apellidosForm=i),c(i)}),l()(),r(13,"ion-item")(14,"ion-input",8),b("ngModelChange",function(i){return m(h),_(e.nifForm,i)||(e.nifForm=i),c(i)}),l()(),r(15,"ion-item")(16,"ion-input",9),b("ngModelChange",function(i){return m(h),_(e.emailForm,i)||(e.emailForm=i),c(i)}),P("ionInput",function(){return m(h),c(e.validateEmail())}),l()(),r(17,"ion-item")(18,"ion-input",10),b("ngModelChange",function(i){return m(h),_(e.telefonoForm,i)||(e.telefonoForm=i),c(i)}),l()(),r(19,"ion-item")(20,"ion-input",11),b("ngModelChange",function(i){return m(h),_(e.direccionForm,i)||(e.direccionForm=i),c(i)}),l()(),r(21,"ion-item")(22,"ion-input",12),b("ngModelChange",function(i){return m(h),_(e.ciudadForm,i)||(e.ciudadForm=i),c(i)}),l()(),r(23,"ion-item")(24,"ion-input",13),b("ngModelChange",function(i){return m(h),_(e.codigoPostalForm,i)||(e.codigoPostalForm=i),c(i)}),l()(),r(25,"ion-item")(26,"ion-input",14),b("ngModelChange",function(i){return m(h),_(e.paisForm,i)||(e.paisForm=i),c(i)}),l()(),E(27,de,5,0,"ng-container",15)(28,pe,11,8,"ng-container",15),l()()()}s&2&&(n("translucent",!0),t(2),n("ngIf",!e.modoEdicion),t(3),n("fullscreen",!0),t(4),p("invalid",!e.nombre&&e.formSubmitted),t(),f("ngModel",e.nombreForm),n("readonly",!e.modoEdicion),t(),p("invalid",!e.apellidos&&e.formSubmitted),t(),f("ngModel",e.apellidosForm),n("readonly",!e.modoEdicion),t(),p("invalid",!e.nif&&e.formSubmitted),t(),f("ngModel",e.nifForm),n("readonly",!e.modoEdicion),t(),p("invalid",(!e.email||!e.isEmailValid())&&e.formSubmitted),t(),f("ngModel",e.emailForm),n("readonly",!e.modoEdicion),t(),p("invalid",!e.telefono&&e.formSubmitted),t(),f("ngModel",e.telefonoForm),n("readonly",!e.modoEdicion),t(),p("invalid",!e.direccion&&e.formSubmitted),t(),f("ngModel",e.direccionForm),n("readonly",!e.modoEdicion),t(),p("invalid",!e.ciudad&&e.formSubmitted),t(),f("ngModel",e.ciudadForm),n("readonly",!e.modoEdicion),t(),p("invalid",!e.codigoPostal&&e.formSubmitted),t(),f("ngModel",e.codigoPostalForm),n("readonly",!e.modoEdicion),t(),p("invalid",!e.pais&&e.formSubmitted),t(),f("ngModel",e.paisForm),n("readonly",!e.modoEdicion),t(),n("ngIf",!e.modoEdicion),t(),n("ngIf",e.modoEdicion))},dependencies:[z,j,U,J,D,B,H,L,k,x,O,q,A,N,le,Y,Z,$,ee,ie,te,oe,ne,ae,X,re,Q,G,R],styles:[".updateCliente[_ngcontent-%COMP%]{padding-left:20px;padding-right:20px;padding-top:20px}.boton-editar-guardar[_ngcontent-%COMP%]{padding:20px}.boton-atras[_ngcontent-%COMP%], .boton-cancelar[_ngcontent-%COMP%]{padding-right:20px;padding-left:20px}.boton-eliminar[_ngcontent-%COMP%], .boton-habilitar[_ngcontent-%COMP%]{padding:20px}.invalid[_ngcontent-%COMP%]{border:2px solid red;--ion-color: red}.error-text[_ngcontent-%COMP%]{color:red;font-size:14px;text-align:center;margin-top:5px}.disabled[_ngcontent-%COMP%]{pointer-events:auto}"]});let a=u;return a})();export{Te as ClienteDetallePage};
