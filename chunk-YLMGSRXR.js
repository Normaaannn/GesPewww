import{a as x}from"./chunk-GGPG3CNO.js";import{Ab as L,B as f,D as a,E as i,F as l,K as C,Kb as z,La as P,Lb as J,S as t,U as r,V as h,aa as u,ba as I,eb as T,ga as F,gb as A,hb as B,ja as S,ka as y,la as k,lb as _,mb as w,nb as N,ob as O,pb as M,qb as $,r as n,rb as j,s as g,tb as U,u as v,ua as D,xb as G,y as E,yb as R,zb as H}from"./chunk-37LTOCVS.js";import"./chunk-L2GIMNSN.js";import"./chunk-7KGURMOZ.js";import"./chunk-YZINE4VV.js";import"./chunk-OITPVWB3.js";import"./chunk-YXCBSPVC.js";import"./chunk-HII7ZFLR.js";import"./chunk-7JVEMCNU.js";import"./chunk-Z65EUC5N.js";import"./chunk-4U6PRYVA.js";import"./chunk-ETCIABSX.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import"./chunk-RW4GY4BD.js";function V(p,c){if(p&1&&(a(0,"ion-accordion")(1,"ion-item",7)(2,"ion-label"),t(3),u(4,"number"),i()(),a(5,"div",8)(6,"p")(7,"strong"),t(8,"Descripci\xF3n:"),i(),t(9),i(),a(10,"p")(11,"strong"),t(12,"IVA:"),i(),t(13),i(),a(14,"p")(15,"strong"),t(16,"Cantidad:"),i(),t(17),i(),a(18,"p")(19,"strong"),t(20,"Precio unitario neto:"),i(),t(21),u(22,"number"),i(),a(23,"p")(24,"strong"),t(25,"Precio unitario bruto:"),i(),t(26),u(27,"number"),i()()()),p&2){let d=c.$implicit;n(3),h(" ",d.nombreProducto," - ",I(4,7,d.subtotal,"1.2-2")," \u20AC "),n(6),r(" ",d.descripcion,""),n(4),r(" ",d.iva,"%"),n(4),r(" ",d.cantidad,""),n(4),r(" ",I(22,10,d.precio,"1.2-2")," \u20AC"),n(5),r(" ",I(27,13,d.precio+d.precio*d.iva/100,"1.2-2")," \u20AC")}}var ee=(()=>{let c=class c{constructor(o){this.router=o}ngOnInit(){let o=this.router.getCurrentNavigation();o!=null&&o.extras.state&&(this.pedidoId=o.extras.state.pedidoId,this.pedidoFecha=o.extras.state.pedidoFecha,this.cliente=o.extras.state.cliente,this.usuarioCreador=o.extras.state.usuarioCreador,this.loadDetalles())}loadDetalles(){let o=localStorage.getItem("accessToken");if(!o){console.log("No se encontr\xF3 el token de acceso");return}let s=x.apiUrl+`/pedidos/${this.pedidoId}/detalles`;fetch(s,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`}}).then(e=>{if(!e.ok)throw new Error("Error en la solicitud");return e.json()}).then(e=>{console.log("Respuesta completa:",e),typeof e=="string"&&(e=JSON.parse(e),console.log("Convertido a JSON:",e)),Array.isArray(e)?this.detalles=e:e&&e.content?this.detalles=e.content:console.warn("Formato de datos inesperado:",e)})}generarPDF(){let o=localStorage.getItem("accessToken");if(!o){console.log("No se encontr\xF3 el token de acceso");return}let s=x.apiUrl+`/pedido/factura/${this.pedidoId}/pdf`;fetch(s,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`}}).then(e=>{if(!e.ok)throw new Error("Error en la solicitud");return e.blob()}).then(e=>{let b=window.URL.createObjectURL(e),m=document.createElement("a");m.href=b,m.download=`pedido_${this.pedidoId}.pdf`,document.body.appendChild(m),m.click(),m.remove()}).catch(e=>{console.error("Error al generar el PDF:",e)})}};c.\u0275fac=function(s){return new(s||c)(g(D))},c.\u0275cmp=v({type:c,selectors:[["app-pedido-detalle"]],decls:37,vars:17,consts:[[3,"translucent"],["slot","start"],["defaultHref","/pedidos"],[3,"fullscreen"],[1,"centrar"],[4,"ngFor","ngForOf"],["expand","block","color","primary",1,"ion-no-margin","ion-no-padding",3,"click"],["slot","header"],["slot","content",1,"ion-padding"]],template:function(s,e){s&1&&(a(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),l(3,"ion-back-button",2),i(),a(4,"ion-title"),t(5),i()()(),a(6,"ion-content",3)(7,"div",4)(8,"ion-card")(9,"ion-card-header")(10,"ion-card-title"),t(11),i(),a(12,"ion-card-subtitle"),t(13),l(14,"br"),t(15),u(16,"date"),i()(),a(17,"ion-card-content"),t(18),l(19,"br"),t(20),l(21,"br"),t(22),l(23,"br"),t(24),l(25,"br"),t(26),l(27,"br")(28,"br"),t(29),l(30,"br"),i()(),a(31,"ion-accordion-group"),E(32,V,28,16,"ion-accordion",5),i()()(),a(33,"ion-footer",4)(34,"ion-button",6),C("click",function(){return e.generarPDF()}),t(35," Generar PDF "),i(),l(36,"br"),i()),s&2&&(f("translucent",!0),n(5),r("Pedido #",e.pedidoId,""),n(),f("fullscreen",!0),n(5),h("",e.cliente.nombre," ",e.cliente.apellidos,""),n(2),r("NIF/DNI: ",e.cliente.nif,""),n(2),r("Fecha emisi\xF3n: ",I(16,14,e.pedidoFecha,"dd-MM-yyyy"),""),n(3),r(" Email: ",e.cliente.email,""),n(2),r(" Telefono: ",e.cliente.telefono,""),n(2),r(" Direccion: ",e.cliente.direccion,""),n(2),r(" Ciudad: ",e.cliente.ciudad,""),n(2),r(" Pais: ",e.cliente.pais,""),n(3),r(" Usuario creador: ",e.usuarioCreador,""),n(3),f("ngForOf",e.detalles))},dependencies:[U,R,z,J,k,F,y,S,P,A,B,H,L,_,w,T,N,O,M,$,j,G],encapsulation:2});let p=c;return p})();export{ee as PedidoDetallePage};
